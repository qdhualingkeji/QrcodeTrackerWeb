<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qdhualing.qrcodetracker.dao.MainDao">

    <select id="getBcpTkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.BcpTkdBean">
        SELECT distinct t.*
        FROM Tkd_Bcp t,M_BCPBk m
        WHERE t.BackDh=m.BackDh
        and (t.ThR = #{0} and BzStatus=0 and TlfzrStatus=0 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and SlfzrStatus=0)
        or (t.ThR = #{0} and BzStatus=2)
        or (t.ThR = #{0} and TlfzrStatus=2)
        or (t.ThR = #{0} and ZjyStatus=2)
        or (t.ThR = #{0} and ZjldStatus=2)
        or (t.ThR = #{0} and KgStatus=2)
        or (t.ThR = #{0} and SlfzrStatus=2)
    </select>
    <select id="getBcpCkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        SELECT distinct c.*
        FROM Ckd_Bcp c,M_BCPOut m
        WHERE c.FhR = #{0} AND c.OutDh=m.OutDh AND (KgStatus = 2 OR FzrStatus = 2 OR BzStatus = 2 OR LlfzrStatus = 2 OR FzrStatus = 0 AND KgStatus = 0)
    </select>
    <select id="getCpCkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        SELECT distinct c.*
        FROM Ckd_Bcp c,M_CPOut m
        WHERE c.FhR = #{0} AND c.OutDh=m.OutDh AND (KgStatus = 2 OR FzrStatus = 2 OR FzrStatus = 0 AND KgStatus = 0)
    </select>
    <select id="getBcpRkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        SELECT * FROM (
        SELECT distinct r.*
        FROM Rkd_Bcp r,M_BCPIn m
        WHERE r.InDh=m.InDh
        ) t WHERE JhR = #{0} AND (BzStatus = 2 OR FzrStatus = 2 OR ZjyStatus = 2 OR ZjldStatus = 2 OR FzrStatus = 0 AND ZjyStatus = 0)
    </select>
    <select id="getCpRkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        SELECT distinct r.*
        FROM Rkd_Bcp r,M_CPIn2 m
        WHERE JhR = #{0} AND r.InDh=m.InDh AND (BzStatus = 2 OR FlfzrStatus = 2 OR ZjyStatus = 2 OR ZjldStatus = 2 OR KgStatus = 2 OR LlfzrStatus = 2 OR FlfzrStatus = 0 AND ZjyStatus = 0)
    </select>
    <select id="getWlTkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.WlTkdBean">
        SELECT distinct t.*
        FROM Tkd_Wl t,M_WLBk m
        WHERE ThR = #{0} AND t.BackDh=m.OutDh AND (BzStatus = 2 OR TlfzrStatus = 2 OR KgStatus = 2 OR SlfzrStatus = 2 OR TlfzrStatus = 0 AND SlfzrStatus = 0)
    </select>
    <select id="getWlCkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.WlCkdBean">
        SELECT distinct c.*
        FROM Ckd_Wl c,M_WLOUT m
        WHERE LhR = #{0} AND c.OutDh=m.OutDh AND (KgStatus = 2 OR FlfzrStatus = 2 OR BzStatus = 2 OR LlfzrStatus = 2 OR KgStatus = 0 AND FlfzrStatus = 0 AND BzStatus = 0 AND LlfzrStatus = 0)
    </select>
    <select id="getWlRkCanModifyData" resultType="com.qdhualing.qrcodetracker.bean.WlRkdBean">
        SELECT distinct r.*
        FROM Rkd_Wl r,M_WLIn m
        WHERE ShR = #{0} AND r.InDh=m.InDh AND (FzrStatus = 2 OR ZjyStatus = 2 OR ZjldStatus = 2 OR FzrStatus = 0 AND ZjyStatus = 0)
    </select>

    <select id="getAllPerson" resultType="com.qdhualing.qrcodetracker.bean.PersonBean" parameterType="com.qdhualing.qrcodetracker.model.User">
		SELECT *
        FROM Hl_User where GroupID=#{GroupID}
        <if test="CheckQXGroup!=null">
            <bind name="pattern" value="'%'+CheckQXGroup+'%'"/>
            AND CheckQXGroup LIKE #{pattern}
        </if>
	</select>

    <select id="searchAllPerson" resultType="com.qdhualing.qrcodetracker.bean.PersonBean">
        SELECT UserID,LoginName,TrueName,GroupName,RegTime FROM Hl_User u LEFT JOIN Hl_UserGroup ug ON u.GroupID=ug.GroupID ORDER BY RegTime DESC
    </select>

    <select id="getPersonById" resultType="com.qdhualing.qrcodetracker.bean.PersonResult">
        SELECT UserID,TrueName,LoginName,RegTime,u.GroupID,GroupName,CheckQXGroup FROM Hl_User u LEFT JOIN Hl_UserGroup ug ON u.GroupID=ug.GroupID WHERE UserID=#{0}
    </select>

    <update id="updateBcpCkdData" parameterType="com.qdhualing.qrcodetracker.bean.BcpOutVerifyResult">
        UPDATE Ckd_Bcp SET
        <if test="kgID!=null">
          KgID=#{kgID},
        </if>
        <if test="kg!=null">
          Kg=#{kg},
        </if>
        <if test="kgStatus!=null">
          KgStatus=#{kgStatus},
        </if>
        <if test="fzrID!=null">
          FzrID=#{fzrID},
        </if>
        <if test="fhFzr!=null">
          FhFzr=#{fhFzr},
        </if>
        <if test="fzrStatus!=null">
          FzrStatus=#{fzrStatus},
        </if>
        <if test="bzID!=null">
          BzID=#{bzID},
        </if>
        <if test="bz!=null">
          Bz=#{bz},
        </if>
        <if test="bzStatus!=null">
          BzStatus=#{bzStatus},
        </if>
        <if test="llfzrID!=null">
          LlfzrID=#{llfzrID},
        </if>
        <if test="lhFzr!=null">
          LhFzr=#{lhFzr},
        </if>
        <if test="llfzrStatus!=null">
          LlfzrStatus=#{llfzrStatus},
        </if>
        <if test="remark!=null">
          Remark=#{remark}
        </if>
        WHERE OutDh = #{outDh}
    </update>

    <update id="updateCpCkdData" parameterType="com.qdhualing.qrcodetracker.bean.CpOutVerifyResult">
        UPDATE Ckd_Bcp SET
        <if test="kgID!=null">
          KgID=#{kgID},
        </if>
        <if test="kg!=null">
          Kg=#{kg},
        </if>
        <if test="kgStatus!=null">
          KgStatus=#{kgStatus},
        </if>
        <if test="fzrID!=null">
          FzrID=#{fzrID},
        </if>
        <if test="fhFzr!=null">
          FhFzr=#{fhFzr},
        </if>
        <if test="fzrStatus!=null">
          FzrStatus=#{fzrStatus},
        </if>
        <if test="remark!=null">
          Remark=#{remark}
        </if>
        WHERE OutDh = #{outDh}
    </update>

    <update id="updateBcpTkData" parameterType="com.qdhualing.qrcodetracker.bean.BcpTkShowBean">
        UPDATE M_BCPBk SET TKZL=#{tKZL},
        <if test="tKZL!=tKZL1">
            SYZL=SYZL-#{tKZL}+#{tKZL1},
        </if>
        SHL=#{shl},remark=#{remark}
        WHERE QRCode_ID = #{qRCodeID} AND ID = #{id}
    </update>
    <update id="updateBcpTkdData" parameterType="com.qdhualing.qrcodetracker.bean.BcpTkVerifyResult">
        UPDATE Tkd_Bcp SET
        <if test="thDw!=null">
            ThDw = #{thDw},
        </if>
        <if test="shR!=null">
            ShR=#{shR},
        </if>
        <if test="bzID!=null">
            BzID=#{bzID},
        </if>
        <if test="bz!=null">
            Bz=#{bz},
        </if>
        <if test="bzStatus!=null">
            BzStatus=#{bzStatus},
        </if>
        <if test="tlfzrID!=null">
            TlfzrID=#{tlfzrID},
        </if>
        <if test="thFzr!=null">
            ThFzr=#{thFzr},
        </if>
        <if test="tlfzrStatus!=null">
            TlfzrStatus=#{tlfzrStatus},
        </if>
        <if test="zjyID!=null">
            ZjyID=#{zjyID},
        </if>
        <if test="zjy!=null">
            Zjy=#{zjy},
        </if>
        <if test="zjyStatus!=null">
            ZjyStatus=#{zjyStatus},
        </if>
        <if test="zjldID!=null">
            ZjldID=#{zjldID},
        </if>
        <if test="zjld!=null">
            Zjld=#{zjld},
        </if>
        <if test="zjldStatus!=null">
            ZjldStatus=#{zjldStatus},
        </if>
        <if test="kgID!=null">
            KgID=#{kgID},
        </if>
        <if test="kg!=null">
            Kg=#{kg},
        </if>
        <if test="kgStatus!=null">
            KgStatus=#{kgStatus},
        </if>
        <if test="slfzrID!=null">
            SlfzrID=#{slfzrID},
        </if>
        <if test="shFzr!=null">
            ShFzr=#{shFzr},
        </if>
        <if test="slfzrStatus!=null">
            SlfzrStatus=#{slfzrStatus},
        </if>
        <if test="remark!=null">
            Remark=#{remark}
        </if>
        WHERE BackDh = #{backDh}
    </update>

    <update id="updateBigCpInData" parameterType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        UPDATE M_CPIn2 SET CP_Code = #{wLCode}, CP_Name=#{productName}, SortID=#{sortID}, YLPC=#{yLPC},
        DWZL=#{dWZL}, GG=#{gG}, DW=#{dW}
        WHERE QRCode_ID = #{qRCodeID}
    </update>
    <update id="updateSmallCpInData" parameterType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        UPDATE M_CPIn SET CP_Code = #{wLCode}, CP_Name=#{productName}, SortID=#{sortID}, YLPC=#{yLPC},
        DWZL=#{dWZL}, SHL=#{shl}, GG=#{gG}, DW=#{dW}
        WHERE QRCode_ID = #{qRCodeID}
    </update>
    <update id="updateBcpInData" parameterType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        UPDATE M_BCPIn SET BCP_Code = #{wLCode}, ProductName=#{productName}, SortID=#{sortID}, YLPC=#{yLPC},
        RKZL=#{rKZL}, DWZL=#{dWZL}, SYZL=#{sYZL}, SHL=#{shl}, GG=#{gG}, DW=#{dW}
        WHERE QRCode_ID = #{qRCodeID}
    </update>
    <update id="updateBcpRkdData" parameterType="com.qdhualing.qrcodetracker.bean.BcpInVerifyResult">
        UPDATE Rkd_Bcp SET
        <if test="jhDw!=null">
            JhDw = #{jhDw},
        </if>
        <if test="shR!=null">
            ShR=#{shR},
        </if>
        <if test="bzID!=null">
            BzID=#{bzID},
        </if>
        <if test="bz!=null">
            Bz=#{bz},
        </if>
        <if test="bzStatus!=null">
            BzStatus=#{bzStatus},
        </if>
        <if test="fzrID!=null">
            FzrID=#{fzrID},
        </if>
        <if test="fzr!=null">
            Fzr=#{fzr},
        </if>
        <if test="fzrStatus!=null">
            FzrStatus=#{fzrStatus},
        </if>
        <if test="zjyID!=null">
            ZjyID=#{zjyID},
        </if>
        <if test="zjy!=null">
            Zjy=#{zjy},
        </if>
        <if test="zjyStatus!=null">
            ZjyStatus=#{zjyStatus},
        </if>
        <if test="zjldID!=null">
            ZjldID=#{zjldID},
        </if>
        <if test="zjld!=null">
            Zjld=#{zjld},
        </if>
        <if test="zjldStatus!=null">
            ZjldStatus=#{zjldStatus},
        </if>
        <if test="flfzrID!=null">
            FlfzrID=#{flfzrID},
        </if>
        <if test="jhFzr!=null">
            JhFzr=#{jhFzr},
        </if>
        <if test="flfzrStatus!=null">
            FlfzrStatus=#{flfzrStatus},
        </if>
        <if test="kgID!=null">
            KgID=#{kgID},
        </if>
        <if test="kg!=null">
            Kg=#{kg},
        </if>
        <if test="kgStatus!=null">
            KgStatus=#{kgStatus},
        </if>
        <if test="llfzrID!=null">
            LlfzrID=#{llfzrID},
        </if>
        <if test="shFzr!=null">
            ShFzr=#{shFzr},
        </if>
        <if test="llfzrStatus!=null">
            LlfzrStatus=#{llfzrStatus},
        </if>
        <if test="remark!=null">
            Remark=#{remark}
        </if>
        WHERE InDh = #{inDh}
    </update>

    <update id="updateWlTkData" parameterType="com.qdhualing.qrcodetracker.bean.WLTkShowBean">
        UPDATE M_WLBk SET TKZL=#{tKZL},
        <if test="tKZL!=tKZL1">
            SYZL=SYZL-#{tKZL}+#{tKZL1},
        </if>
        SHL=#{shl}
        WHERE QRCode_ID = #{qRCodeID} AND ID = #{id}
    </update>
    <update id="updateWlTkdData" parameterType="com.qdhualing.qrcodetracker.bean.WlTkVerifyResult">
        UPDATE Tkd_Wl SET ThDw = #{thDw}, ThR=#{thR}, ShR=#{shR}, BzID=#{bzID}, Bz=#{bz}, BzStatus=#{bzStatus}, TlfzrID=#{tlfzrID}, ThFzr=#{thFzr},
        TlfzrStatus=#{tlfzrStatus}, KgID=#{kgID}, Kg=#{kg}, KgStatus=#{kgStatus}, SlfzrID=#{slfzrID}, ShFzr=#{shFzr}, SlfzrStatus=#{slfzrStatus}, Remark=#{remark}
        WHERE BackDh = #{backDh}
    </update>

    <update id="updateWlOutData" parameterType="com.qdhualing.qrcodetracker.bean.WLINShowBean">
        UPDATE M_WLOUT SET CKZL=#{cKZL},
        <if test="cKZL!=cKZL1">
        SYZL=SYZL-#{cKZL}+#{cKZL1},
        </if>
        SHL=#{shl}
        WHERE QRCode_ID = #{qRCodeID} AND ID = #{id}
    </update>

    <update id="updateBcpOutData" parameterType="com.qdhualing.qrcodetracker.bean.BcpOutShowBean">
        UPDATE M_BCPOut SET CKZL=#{cKZL},
        <if test="cKZL!=cKZL1">
        SYZL=SYZL-#{cKZL}+#{cKZL1},
        </if>
        SHL=#{shl}
        WHERE QRCode_ID = #{qRCodeID} AND ID = #{id}
    </update>

    <update id="updateWlCkdData" parameterType="com.qdhualing.qrcodetracker.bean.WlOutVerifyResult">
        UPDATE Ckd_Wl SET LhDw = #{lhDw}, KgID=#{kgID}, Kg=#{kg}, KgStatus=#{kgStatus}, FlfzrID=#{flfzrID}, FhFzr=#{fhFzr}, FlfzrStatus=#{flfzrStatus}, BzID=#{bzID}, Bz=#{bz}, BzStatus=#{bzStatus}, LlfzrID=#{llfzrID}, LhFzr=#{lhFzr}, LlfzrStatus=#{llfzrStatus}, Remark=#{remark}
        WHERE OutDh = #{outDh}
    </update>

    <update id="updateWlInData" parameterType="com.qdhualing.qrcodetracker.bean.WLINShowBean">
        UPDATE M_WLIn SET WL_Code = #{wLCode}, ProductName=#{productName}, SortID=#{sortID}, YLPC=#{yLPC}, PCZL=#{pCZL},
        DWZL=#{dWZL}, SYZL=#{sYZL}, SHL=#{shl}, CHD=#{cHD}, GG=#{gG}, Unit=#{unit}, remark=#{remark}
        WHERE QRCode_ID = #{qRCodeID}
    </update>
    <update id="updateWlRkdData" parameterType="com.qdhualing.qrcodetracker.bean.WlInVerifyResult">
        UPDATE Rkd_Wl SET JhDw = #{fhDw}, ShRq=#{shRq},
        ZjyID=#{zjyID}, Zjy=#{zjy}, ZjyStatus=#{zjyStatus}, ZjldID=#{zjldID}, Zjld=#{zjld}, ZjldStatus=#{zjldStatus},FzrID=#{fzrID}, ShFzr=#{shFzr}, FzrStatus=#{fzrStatus},  Remark=#{remark}
        WHERE InDh = #{inDh}
    </update>

    <update id="changeBIG_CPInPassCheckFlag">
        UPDATE M_CPIn2 SET ZJZT = #{2}, ZJY=#{1}
        WHERE QRCode_ID = #{0}
    </update>

    <update id="changeSMALL_CPInPassCheckFlag">
        UPDATE M_CPIn SET ZJZT = #{2}, ZJY=#{1}
        WHERE QRCode_ID = #{0}
    </update>

    <update id="changeBCPInPassCheckFlag">
        UPDATE M_BCPIn SET ZJZT = #{2}, ZJY=#{1}
        WHERE QRCode_ID = #{0}
    </update>

    <update id="changeWLInPassCheckFlag">
        UPDATE M_WLIn SET ZJZT = 1, ZJY=#{1}
        WHERE QRCode_ID = #{0}
    </update>


    <select id="getBigCpIn2ShowData" resultType="com.qdhualing.qrcodetracker.bean.BigCpTrackResult">
        SELECT M_CPIn2.CP_Name , M_CPIn2.YLPC , M_CPIn2.SCPC ,M_CPIn2.CP_Code,
        M_CPIn2.SC_Time , M_CPIn2.GG , Hl_Sort.Sort_Name ,M_CPIn2.DWZL,
        M_CPIn2.CZY ,M_CPIn2.DW
        FROM M_CPIn2 LEFT JOIN Hl_Sort on M_CPIn2.SortID = Hl_Sort.SortID
        WHERE M_CPIn2.QRCode_ID = #{0}
    </select>
    <select id="getSmallCpInShowData" resultType="com.qdhualing.qrcodetracker.bean.SmallCpTrackResult">
        SELECT M_CPIn.CP_Name , M_CPIn.YLPC , M_CPIn.SCPC ,M_CPIn.CP_Code,
        M_CPIn.SC_Time , M_CPIn.GG , Pdt_Sort2.Sort_Name ,M_CPIn.DWZL,
        M_CPIn.CZY ,M_CPIn.DW
        FROM M_CPIn LEFT JOIN Pdt_Sort2 on M_CPIn.SortID = Pdt_Sort2.ID
        WHERE M_CPIn.QRCode_ID = #{0}
    </select>
    <select id="getBcpInShowData" resultType="com.qdhualing.qrcodetracker.bean.BcpTrackResult">
        SELECT M_BCPIn.ProductName, M_BCPIn.SortID, M_BCPIn.YLPC , M_BCPIn.SCPC ,M_BCPIn.BCP_Code,
        M_BCPIn.SC_Time , M_BCPIn.GG , Pdt_Sort2.Sort_Name ,M_BCPIn.DWZL,
        M_BCPIn.CZY ,M_BCPIn.ZJY ,M_BCPIn.ZJZT ,M_BCPIn.DW ,M_BCPIn.CheJian ,M_BCPIn.GX ,
        M_BCPIn.Yl_1,M_BCPIn.Yl_2,M_BCPIn.Yl_3,M_BCPIn.Yl_4,M_BCPIn.Yl_5,M_BCPIn.Yl_6,M_BCPIn.Yl_7,M_BCPIn.Yl_8,M_BCPIn.Yl_9,M_BCPIn.Yl_10
        FROM M_BCPIn LEFT JOIN Pdt_Sort2 on M_BCPIn.SortID = Pdt_Sort2.ID
        WHERE M_BCPIn.QRCode_ID = #{0}
    </select>

    <update id="refuseBcpTk" parameterType="com.qdhualing.qrcodetracker.bean.BcpTkdBean">
        UPDATE Tkd_Bcp SET
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus}
        </if>
        <if test="tlfzrStatus!=0">
            tlfzrStatus=#{tlfzrStatus}
        </if>
        <if test="zjyStatus!=0">
            zjyStatus=#{zjyStatus}
        </if>
        <if test="zjldStatus!=0">
            zjldStatus=#{zjldStatus}
        </if>
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="slfzrStatus!=0">
            slfzrStatus=#{slfzrStatus}
        </if>
        WHERE BackDh = #{backDh}
    </update>
    <update id="agreeBcpTk" parameterType="com.qdhualing.qrcodetracker.bean.BcpTkdBean">
        UPDATE Tkd_Bcp SET
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus},tlfzrStatus=0,zjyStatus=0,zjldStatus=0,kgStatus=0,slfzrStatus=0
        </if>
        <if test="tlfzrStatus!=0">
            tlfzrStatus=#{tlfzrStatus}
        </if>
        <if test="zjyStatus!=0">
            zjyStatus=#{zjyStatus}
        </if>
        <if test="zjldStatus!=0">
            zjldStatus=#{zjldStatus}
        </if>
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="slfzrStatus!=0">
            slfzrStatus=#{slfzrStatus}
        </if>
        WHERE BackDh = #{backDh}
    </update>
    <update id="refuseBcpOut" parameterType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        UPDATE Ckd_Bcp SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="refuseCpOut" parameterType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        UPDATE Ckd_Bcp SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="agreeBcpOut" parameterType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        UPDATE Ckd_Bcp SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus},fzrStatus=0,bzStatus=0,llfzrStatus=0
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="agreeCpOut" parameterType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        UPDATE Ckd_Bcp SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus},fzrStatus=0
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="refuseBcpIn" parameterType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        UPDATE Rkd_Bcp SET
        <if test="bcpBzStatus!=0">
            bzStatus=#{bzStatus},fzrStatus=0,zjyStatus=0,zjldStatus=0
        </if>
        <if test="cpBzStatus!=0">
            bzStatus=#{bzStatus},flfzrStatus=0,zjyStatus=0,zjldStatus=0,kgStatus=0,llfzrStatus=0
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        <if test="zjyStatus!=0">
            zjyStatus=#{zjyStatus}
        </if>
        <if test="zjldStatus!=0">
            zjldStatus=#{zjldStatus}
        </if>
        <if test="flfzrStatus!=0">
            flfzrStatus=#{flfzrStatus}
        </if>
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE InDh = #{inDh}
    </update>
    <update id="agreeBcpIn" parameterType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        UPDATE Rkd_Bcp SET
        <if test="bcpBzStatus!=0">
            bzStatus=#{bzStatus},fzrStatus=0,zjyStatus=0,zjldStatus=0
        </if>
        <if test="cpBzStatus!=0">
            bzStatus=#{bzStatus},flfzrStatus=0,zjyStatus=0,zjldStatus=0,kgStatus=0,llfzrStatus=0
        </if>
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        <if test="zjyStatus!=0">
            zjyStatus=#{zjyStatus}
        </if>
        <if test="zjldStatus!=0">
            zjldStatus=#{zjldStatus}
        </if>
        <if test="flfzrStatus!=0">
            flfzrStatus=#{flfzrStatus}
        </if>
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE InDh = #{inDh}
    </update>
    <update id="refuseWlTk" parameterType="com.qdhualing.qrcodetracker.bean.WlTkdBean">
        UPDATE Tkd_Wl SET
        <if test="bzStatus!=0">
            BzStatus=#{bzStatus}
        </if>
        <if test="tlfzrStatus!=0">
            TlfzrStatus=#{tlfzrStatus}
        </if>
        <if test="kgStatus!=0">
            KgStatus=#{kgStatus}
        </if>
        <if test="slfzrStatus!=0">
            SlfzrStatus=#{slfzrStatus}
        </if>
        WHERE BackDh = #{backDh}
    </update>
    <update id="agreeWlTk" parameterType="com.qdhualing.qrcodetracker.bean.WlTkdBean">
        UPDATE Tkd_Wl SET
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus},tlfzrStatus=0,kgStatus=0,slfzrStatus=0
        </if>
        <if test="tlfzrStatus!=0">
            tlfzrStatus=#{tlfzrStatus}
        </if>
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="slfzrStatus!=0">
            slfzrStatus=#{slfzrStatus}
        </if>
        WHERE BackDh = #{backDh}
    </update>
    <update id="refuseWlOut" parameterType="com.qdhualing.qrcodetracker.bean.WlCkdBean">
        UPDATE Ckd_Wl SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus}
        </if>
        <if test="flfzrStatus!=0">
            flfzrStatus=#{flfzrStatus}
        </if>
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="agreeWlOut" parameterType="com.qdhualing.qrcodetracker.bean.WlCkdBean">
        UPDATE Ckd_Wl SET
        <if test="kgStatus!=0">
            kgStatus=#{kgStatus},flfzrStatus=0,bzStatus=0,llfzrStatus=0
        </if>
        <if test="flfzrStatus!=0">
            flfzrStatus=#{flfzrStatus}
        </if>
        <if test="bzStatus!=0">
            bzStatus=#{bzStatus}
        </if>
        <if test="llfzrStatus!=0">
            llfzrStatus=#{llfzrStatus}
        </if>
        WHERE OutDh = #{outDh}
    </update>
    <update id="refuseWlIn" parameterType="com.qdhualing.qrcodetracker.bean.WlRkdBean">
        UPDATE Rkd_Wl SET
        <if test="fzrStatus!=0">
            fzrStatus=#{fzrStatus}
        </if>
        <if test="zjyStatus!=0">
            zjyStatus=#{zjyStatus}
        </if>
        <if test="zjldStatus!=0">
            zjldStatus=#{zjldStatus}
        </if>
        WHERE InDh = #{inDh}
    </update>
    <update id="agreeWlIn" parameterType="com.qdhualing.qrcodetracker.bean.WlRkdBean">
        UPDATE Rkd_Wl SET
        <if test="fzrStatus==1">
            fzrStatus=${fzrStatus}
        </if>
        <if test="zjyStatus==1">
            zjyStatus=${zjyStatus},zjldStatus=0,fzrStatus=0
        </if>
        <if test="zjldStatus==1">
            zjldStatus=${zjldStatus}
        </if>
        WHERE InDh = #{inDh}
    </update>
    <select id="getBcpTkShowBeanListByBackDh" resultType="com.qdhualing.qrcodetracker.bean.BcpTkShowBean">
        SELECT b.*,b.TKZL as TKZL1,s.SortName
        FROM M_BCPBk b LEFT JOIN Hl_Sort s ON b.SortID = s.SortID
        WHERE BackDh = #{0}
    </select>

    <select id="getBcpTkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpTkdBean">
        SELECT * FROM Tkd_Bcp WHERE BackDh = #{0}
    </select>

    <select id="getBcpOutShowBeanListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.BcpOutShowBean">
        SELECT b.*,b.CKZL as CKZL1,s.SortName
        FROM M_BCPOut b LEFT JOIN Hl_Sort s ON b.SortID = s.SortID
        WHERE OutDh = #{0}
    </select>

    <select id="getCpOutShowBeanListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.CpOutShowBean">
        SELECT c.*,s.SortName
        FROM M_CPOut c LEFT JOIN Hl_Sort s ON c.SortID = s.SortID
        WHERE OutDh = #{0}
    </select>

    <select id="getBigCpOutParamListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.BigCpOutParam">
        SELECT * FROM M_CPOut WHERE OutDh = #{0}
    </select>

    <select id="getBcpCkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        SELECT *
        FROM Ckd_Bcp
        WHERE OutDh = #{0}
    </select>

    <select id="getBigCpInShowBeanListByInDh" resultType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        SELECT QRCode_ID as qRCodeID, CP_Code as wLCode, CP_Name as productName, GG as gG, c.SortID as sortID, s.SortName,
        YLPC as yLPC, SCPC as sCPC, SC_Time as time, Indh as inDh, DW as dW, DWZL as dWZL, CZY as cZY, ZJZT as zjzt
        FROM M_CPIn2 c LEFT JOIN Hl_Sort s ON c.SortID = s.SortID
        WHERE Indh = #{0}
    </select>

    <select id="getBigCPINParamListByInDh" resultType="com.qdhualing.qrcodetracker.bean.BigCPINParam">
        SELECT *,CP_Name AS productName FROM M_CPIn2 WHERE Indh = #{0}
    </select>

    <select id="getCpInShowBeanListByInDh" resultType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        SELECT  QRCode_ID as qRCodeID, CP_Code as wLCode, CP_Name as productName, GG as gG, c.SortID as sortID, s.SortName,
        YLPC as yLPC, SCPC as sCPC, SC_Time as time, InDh as inDh, DW as dW, DWZL as dWZL, CZY as cZY,SHL as shl
        FROM M_CPIn c LEFT JOIN Hl_Sort s ON c.SortID = s.SortID
        WHERE InDh = #{0}
    </select>

    <select id="getCpInShowBeanListByCPS2QRCode" resultType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        SELECT  QRCode_ID as qRCodeID, CP_Code as wLCode, CP_Name as productName, GG as gG, c.SortID as sortID, s.SortName,
        YLPC as yLPC, SCPC as sCPC, SC_Time as time, InDh as inDh, DW as dW, DWZL as dWZL, CZY as cZY,SHL as shl
        FROM M_CPIn c LEFT JOIN Hl_Sort s ON c.SortID = s.SortID
        WHERE CPS2_QRCode = #{0}
    </select>

    <select id="getSmallCPINParamListByInDh" resultType="com.qdhualing.qrcodetracker.bean.SmallCPINParam">
        SELECT *,CP_Name AS productName FROM M_CPIn WHERE InDh = #{0}
    </select>

    <select id="getSmallCPINParamListByCPS2QRCode" resultType="com.qdhualing.qrcodetracker.bean.SmallCPINParam">
        SELECT *,CP_Name AS productName FROM M_CPIn WHERE CPS2_QRCode = #{0} and QRCode_ID not in (SELECT QRCode_ID FROM M_CPS)
    </select>

    <select id="getBcpInShowBeanListByInDh" resultType="com.qdhualing.qrcodetracker.bean.BcpInShowBean">
        SELECT QRCode_ID as qRCodeID, BCP_Code as wLCode, ProductName as productName, GG as gG, b.SortID as sortID, s.SortName as sortName,
        YLPC as yLPC, SCPC as sCPC, SC_Time as time,KS_Time,WC_Time, CheJian as cheJian, GX as gx, CZY as czy, InDh as inDh, DW as dW,RKZL as rKZL, DWZL as dWZL,SYZL as sYZL,ZJZT as Zjzt,
        Yl_1,Tlzl_1,Yl_2,Tlzl_2,Yl_3,Tlzl_3,Yl_4,Tlzl_4,Yl_5,Tlzl_5,Yl_6,Tlzl_6,Yl_7,Tlzl_7,Yl_8,Tlzl_8,Yl_9,Tlzl_9,Yl_10,Tlzl_10,SHL as shl
        FROM M_BCPIn b LEFT JOIN Hl_Sort s ON b.SortID = s.SortID
        WHERE b.InDh = #{0}
    </select>

    <select id="getBcpRkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        SELECT * FROM Rkd_Bcp WHERE InDh = #{0}
    </select>

    <select id="getWLTkShowBeanListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.WLTkShowBean">
        SELECT w.*,w.TKZL as TKZL1,s.SortName
        FROM M_WLBk w,Hl_Sort s
        WHERE w.SortID = s.SortID AND OutDh = #{0}
    </select>

    <select id="getWLTKParamListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.WLTKParam">
        SELECT *,SHL AS tkShL
        FROM M_WLBk
        WHERE OutDh = #{0}
    </select>

    <select id="getBCPTKParamListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.BCPTKParam">
        SELECT *,PCZL AS RKZL
        FROM M_BCPBk
        WHERE BackDh = #{0}
    </select>

    <select id="getWlTkdBean" resultType="com.qdhualing.qrcodetracker.bean.WlTkdBean">
        SELECT * FROM Tkd_Wl WHERE BackDh = #{0}
    </select>

    <select id="getWLOutShowBeanListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.WLOutShowBean">
        SELECT w.*,w.CKZL as CKZL1,s.SortName
        FROM M_WLOUT w,Hl_Sort s
        WHERE w.SortID = s.SortID AND OutDh = #{0}
    </select>

    <select id="getWLOutParamListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.WLOutParam">
        SELECT *,SHL AS ckShL FROM M_WLOUT WHERE OutDh = #{0}
    </select>

    <select id="getBcpOutParamListByOutDh" resultType="com.qdhualing.qrcodetracker.bean.BcpOutParam">
        SELECT o.*,o.SHL AS ckShL,s.SCPC
        FROM M_BCPOUT o,M_BCPS s
        WHERE o.QRCode_ID=s.QRCode_ID AND o.OutDh = #{0}
    </select>

    <select id="getWlCkdBean" resultType="com.qdhualing.qrcodetracker.bean.WlCkdBean">
        SELECT *
        FROM Ckd_Wl
        WHERE OutDh = #{0}
    </select>

    <select id="getWLINShowBeanListByInDh" resultType="com.qdhualing.qrcodetracker.bean.WLINShowBean">
        SELECT w.*,s.SortName
        FROM M_WLIn w,Hl_Sort s
        WHERE w.SortID = s.SortID AND w.InDh = #{0}
    </select>

    <select id="getWlRkdBean" resultType="com.qdhualing.qrcodetracker.bean.WlRkdBean">
        SELECT * FROM Rkd_Wl WHERE InDh = #{0}
    </select>

    <select id="getBcpTkNonCheckData" parameterType="com.qdhualing.qrcodetracker.bean.BcpTkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpTkdBean">
        SELECT distinct t.*
        FROM Tkd_Bcp t,M_BCPBk m
        WHERE t.BackDh=m.BackDh
        <if test="bzID!=null">
            and (BzID=#{bzID} and BzStatus=0 and TlfzrStatus=0 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and SlfzrStatus=0)
            or (BzID=#{bzID} and BzStatus=2)
            or (BzID=#{bzID} and TlfzrStatus=2)
            or (BzID=#{bzID} and ZjyStatus=2)
            or (BzID=#{bzID} and ZjldStatus=2)
            or (BzID=#{bzID} and KgStatus=2)
            or (BzID=#{bzID} and SlfzrStatus=2)
        </if>
        <if test="zjyID!=null">
            and ZjyID=#{zjyID} and BzStatus=1 and TlfzrStatus=1 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and SlfzrStatus=0
        </if>
        <if test="zjldID!=null">
            and ZjldID=#{zjldID} and BzStatus=1 and TlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=0 and KgStatus=0 and SlfzrStatus=0
        </if>
        <if test="kgID!=null">
            and KgID=#{kgID} and BzStatus=1 and TlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=1 and KgStatus=0 and SlfzrStatus=0
        </if>
        <if test="fzrID!=null">
            and (TlfzrID=#{tlfzrID} and BzStatus=1 and TlfzrStatus=0 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and SlfzrStatus=0)
            OR (SlfzrID=#{slfzrID} and BzStatus=1 and TlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=1 and KgStatus=1 and SlfzrStatus=0)
        </if>
    </select>

    <select id="getBcpCkNonCheckData" resultType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        SELECT distinct c.*
        FROM Ckd_Bcp c,M_BcpOUT m
        WHERE c.OutDh=m.OutDh
        <if test="kgID!=null">
            and (KgID = #{kgID} and KgStatus=0 and FzrStatus=0 and BzStatus=0 and LlfzrStatus=0)
            or (KgID = #{kgID} and  KgStatus=2)
            or (KgID = #{kgID} and  FzrStatus=2)
            or (KgID = #{kgID} and  BzStatus=2)
            or (KgID = #{kgID} and  LlfzrStatus=2)
        </if>
        <if test="bzID!=null">
            and BzID = #{bzID} and KgStatus=1 and FzrStatus=1 and BzStatus=0 and LlfzrStatus=0
        </if>
        <if test="fzrID!=null">
            and (FzrID = #{fzrID} and KgStatus=1 and FzrStatus=0 and BzStatus=0 and LlfzrStatus=0)
            or (LlfzrID = #{llfzrID} and KgStatus=1 and FzrStatus=1 and BzStatus=1 and LlfzrStatus=0)
        </if>
    </select>

    <select id="getCpCkNonCheckData" resultType="com.qdhualing.qrcodetracker.bean.BcpCkdBean">
        SELECT distinct c.*
        FROM Ckd_Bcp c,M_CPOut m
        WHERE c.OutDh=m.OutDh
        <if test="kgID!=null">
            and (KgID = #{kgID} and KgStatus=0 and FzrStatus=0)
            or (KgID=#{kgID} and KgStatus=2)
            or (KgID=#{kgID} and FzrStatus=2)
        </if>
        <if test="fzrID!=null">
            and FzrID = #{fzrID} and KgStatus=1 and FzrStatus=0
        </if>
    </select>

    <select id="getBcpRkNonCheckData" parameterType="com.qdhualing.qrcodetracker.bean.BcpRkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        SELECT * FROM (
        SELECT distinct r.*
        FROM Rkd_Bcp r,M_BCPIn m
        WHERE r.InDh=m.InDh
        ) t WHERE 1=1
        <if test="bzID!=null">
            and (BzID=#{bzID} and BzStatus=0 and FzrStatus=0 and ZjyStatus=0 and ZjldStatus=0)
            or (BzID=#{bzID} and ZjyStatus=2)
            or (BzID=#{bzID} and ZjldStatus=2)
            or (BzID=#{bzID} and BzStatus=2)
            or (BzID=#{bzID} and FzrStatus=2)
        </if>
        <if test="fzrID!=null">
            and FzrID=#{fzrID} and BzStatus=1 and FzrStatus=0 and ZjyStatus=0 and ZjldStatus=0
        </if>
        <if test="zjyID!=null">
            and ZjyID=#{zjyID} and BzStatus=1 and FzrStatus=1 and ZjyStatus=0 and ZjldStatus=0
        </if>
        <if test="zjldID!=null">
            and ZjldID=#{zjldID} and BzStatus=1 and FzrStatus=1 and ZjyStatus=1 and ZjldStatus=0
        </if>
    </select>

    <select id="getCpRkNonCheckData" parameterType="com.qdhualing.qrcodetracker.bean.BcpRkdBean" resultType="com.qdhualing.qrcodetracker.bean.BcpRkdBean">
        SELECT distinct r.*
        FROM Rkd_Bcp r,M_CPIn2 m
        WHERE r.InDh=m.InDh
        <if test="bzID!=null">
            and BzID=#{bzID} and BzStatus=0 and FlfzrStatus=0 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and LlfzrStatus=0
            or (BzID=#{bzID} and BzStatus=2)
            or (BzID=#{bzID} and FlfzrStatus=2)
            or (BzID=#{bzID} and ZjyStatus=2)
            or (BzID=#{bzID} and ZjldStatus=2)
            or (BzID=#{bzID} and KgStatus=2)
            or (BzID=#{bzID} and LlfzrStatus=2)
        </if>
        <if test="zjyID!=null">
            and ZjyID=#{zjyID} and BzStatus=1 and FlfzrStatus=1 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and LlfzrStatus=0
        </if>
        <if test="zjldID!=null">
            and ZjldID=#{zjldID} and BzStatus=1 and FlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=0 and KgStatus=0 and LlfzrStatus=0
        </if>
        <if test="kgID!=null">
            and kgID=#{kgID} and BzStatus=1 and FlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=1 and KgStatus=0 and LlfzrStatus=0
        </if>
        <if test="fzrID!=null">
            and FlfzrID=#{flfzrID} and BzStatus=1 and FlfzrStatus=0 and ZjyStatus=0 and ZjldStatus=0 and KgStatus=0 and LlfzrStatus=0
            or (LlfzrID=#{llfzrID} and BzStatus=1 and FlfzrStatus=1 and ZjyStatus=1 and ZjldStatus=1 and KgStatus=1 and LlfzrStatus=0)
        </if>
    </select>

    <select id="getWlTkNonCheckData" parameterType="com.qdhualing.qrcodetracker.bean.WlTkdBean" resultType="com.qdhualing.qrcodetracker.bean.WlTkdBean">
        SELECT distinct t.*
        FROM Tkd_Wl t,M_WLBk m
        WHERE t.BackDh=m.OutDh
        <if test="bzID!=null">
            and (BzID=#{bzID} and BzStatus=0 and TlfzrStatus=0 and KgStatus=0 and SlfzrStatus=0)
            or (BzID=#{bzID} and BzStatus=2)
            or (BzID=#{bzID} and TlfzrStatus=2)
            or (BzID=#{bzID} and KgStatus=2)
            or (BzID=#{bzID} and SlfzrStatus=2)
        </if>
        <if test="kgID!=null">
            and kgID=#{kgID} and BzStatus=1 and TlfzrStatus=1 and KgStatus=0 and SlfzrStatus=0
        </if>
        <if test="fzrID!=null">
            and (TlfzrID = #{tlfzrID} and BzStatus=1 and TlfzrStatus=0 and KgStatus=0 and SlfzrStatus=0)
            or (SlfzrID = #{slfzrID} and BzStatus=1 and TlfzrStatus=1 and KgStatus=1 and SlfzrStatus=0)
        </if>
    </select>

    <select id="getWlCkNonCheckData" resultType="com.qdhualing.qrcodetracker.bean.WlCkdBean">
        SELECT distinct c.*
        FROM Ckd_Wl c,M_WLOUT m
        WHERE c.OutDh=m.OutDh
        <if test="kgID!=null">
            and (KgID = #{kgID} and KgStatus=0 and FlfzrStatus=0 and BzStatus=0 and LlfzrStatus=0)
            or (KgID = #{kgID} and  KgStatus=2)
            or (KgID = #{kgID} and  FlfzrStatus=2)
            or (KgID = #{kgID} and  BzStatus=2)
            or (KgID = #{kgID} and  LlfzrStatus=2)
        </if>
        <if test="bzID!=null">
            and BzID = #{bzID} and KgStatus=1 and FlfzrStatus=1 and BzStatus=0 and LlfzrStatus=0
        </if>
        <if test="fzrID!=null">
            and (FlfzrID = #{flfzrID} and KgStatus=1 and FlfzrStatus=0 and BzStatus=0 and LlfzrStatus=0)
            or (LlfzrID = #{llfzrID} and KgStatus=1 and FlfzrStatus=1 and BzStatus=1 and LlfzrStatus=0)
        </if>
    </select>

    <select id="getWlRkNonCheckData" parameterType="com.qdhualing.qrcodetracker.bean.WlRkdBean" resultType="com.qdhualing.qrcodetracker.bean.WlRkdBean">
        SELECT distinct r.*
        FROM Rkd_Wl r,M_WLIn m
        WHERE r.InDh=m.InDh
        <if test="zjyID!=null">
            and (ZjyID=#{zjyID} and ZjyStatus=0 and ZjldStatus=0 and FzrStatus=0)
            or (ZjyID=#{zjyID} and ZjyStatus=2)
            or (ZjyID=#{zjyID} and ZjldStatus=2)
            or (ZjyID=#{zjyID} and FzrStatus=2)
        </if>
        <if test="zjldID!=null">
            and ZjldID=#{zjldID} and ZjyStatus=1 and ZjldStatus=0 and FzrStatus=0
        </if>
        <if test="fzrID!=null">
            and FzrID=#{fzrID} and ZjyStatus=1 and ZjldStatus=1 and FzrStatus=0
        </if>
    </select>

    <select id="getPersonFromBcpCkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@KG">
            KgID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FZR||personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FLFZR">
            FzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
            BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@LLFZR">
            LlfzrID
        </if>
        FROM Ckd_Bcp
        WHERE OutDh = #{0}
    </select>

    <select id="getPersonFromBcpTkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
            BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@TLFZR">
            TlfzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJY">
            ZjyID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJLD">
            ZjldID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@KG">
            KgID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@SLFZR">
            SlfzrID
        </if>
        FROM Tkd_Bcp
        WHERE BackDh = #{0}
    </select>

    <select id="getPersonFromBcpRkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
            BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FZR">
            FzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJY">
            ZjyID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJLD">
            ZjldID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FLFZR">
            FlfzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@KG">
            KgID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@LLFZR">
            LlfzrID
        </if>
        FROM Rkd_Bcp
        WHERE InDh = #{0}
    </select>

    <select id="getPersonFromWlTkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
            BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@TLFZR">
            TlfzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@KG">
            KgID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@SLFZR">
            SlfzrID
        </if>
        FROM Tkd_Wl
        WHERE BackDh = #{0}
    </select>

    <select id="getPersonFromWlCkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@KG">
            KgID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FLFZR">
            FlfzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
            BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@LLFZR">
            LlfzrID
        </if>
        FROM Ckd_Wl
        WHERE OutDh = #{0}
    </select>

    <select id="getPersonFromWlRkd" resultType="java.lang.String">
        SELECT
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@BZ">
          BzID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@FZR">
          FzrID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJY">
          ZjyID
        </if>
        <if test="personFlag==@com.qdhualing.qrcodetracker.bean.NotificationParam@ZJLD">
          ZjldID
        </if>
        FROM Rkd_Wl
        WHERE InDh = #{0}
    </select>

    <select id="getBigCpIn2" resultType="com.qdhualing.qrcodetracker.bean.BigCpBean">
        SELECT *,ZJZT jyzt
        FROM M_CPIn2
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getSmallCpInData" resultType="com.qdhualing.qrcodetracker.bean.CPINParam">
        SELECT * FROM M_CPIn WHERE QRCode_ID = #{0}
    </select>

    <select id="getComponentBeansFromBcp" resultType="com.qdhualing.qrcodetracker.bean.ComponentBean">
        SELECT DISTINCT QRCode_ID , ProductName as name
        from M_BCPIn
        WHERE QRCode_ID in
        <foreach collection="list" item="qrCodeId" index="index" open="(" close=")" separator=",">
            #{qrCodeId}
        </foreach>
    </select>
    <select id="getComponentBeansFromWl" resultType="com.qdhualing.qrcodetracker.bean.ComponentBean">
        SELECT DISTINCT QRCode_ID , ProductName as name
        from M_WLIn
        WHERE QRCode_ID in
        <foreach collection="list" item="qrCodeId" index="index" open="(" close=")" separator=",">
            #{qrCodeId}
        </foreach>
    </select>
    <select id="getHlSortBySortId" resultType="java.lang.String">
        SELECT SortName
        FROM Hl_Sort
        WHERE SortID = #{0}
    </select>

    <select id="getBcpInData" resultType="com.qdhualing.qrcodetracker.bean.BCPINParam">
        SELECT b.*,u.TrueName zjy,
        case when r.ZjyStatus=1 and r.ZjldStatus=1 and r.BzStatus=1 and r.FzrStatus=1
        then '合格'
        else '不合格'
        end jyzt
        FROM M_BCPIn b,Rkd_Bcp r,Hl_User u
        WHERE b.Indh=r.InDh and r.ZjyID=u.UserID and QRCode_ID = #{0}
    </select>

    <select id="getWlInData" resultType="com.qdhualing.qrcodetracker.bean.WlTrackResult">
        SELECT M_WLIn.ProductName , M_WLIn.YLPC , M_WLIn.PCZL , M_WLIn.DWZL ,M_WLIn.WL_Code,
        M_WLIn.LL_Time , M_WLIn.GG , Hl_Sort.SortName ,
        CASE
        WHEN
        M_WLS.SYZL IS NULL THEN 0
        ELSE M_WLS.SYZL
        END
        SYZL,
        M_WLIn.CHD , M_WLIn.CZY ,M_WLIn.Unit,M_WLIn.Unit dw
        FROM M_WLIn LEFT JOIN M_WLS ON M_WLIn.QRCode_ID = M_WLS.QRCode_ID LEFT JOIN Hl_Sort on M_WLIn.SortID = Hl_Sort.SortID
        WHERE M_WLIn.QRCode_ID = #{0}
    </select>

    <select id="getSmallCpOutData" resultType="com.qdhualing.qrcodetracker.bean.SmallCpOutGetDataResult">
        SELECT m.CP_Name , m.YLPC , m.SCPC , m.SC_Time as scDate , m.GG , s.SortName
        FROM M_CPS m LEFT JOIN Hl_Sort s on m.SortID = s.SortID
        WHERE m.QRCode_ID = #{0}
    </select>

    <select id="getCPS" resultType="com.qdhualing.qrcodetracker.bean.SmallCpBean">
        SELECT *
        FROM M_CPS
        WHERE QRCode_ID = #{0}
    </select>

    <insert id="insertCPOutBySmallParam" parameterType="com.qdhualing.qrcodetracker.bean.SmallCpOutParam">
        insert into M_CPOut
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="cpName!=null">
                CP_Name,
            </if>
            SortID,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="fhDate!=null">
                FHDate,
            </if>
            DWZL,
            <if test="fhr!=null">
                FHR,
            </if>
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="remark!=null">
                remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="cpName!=null">
                #{cpName},
            </if>
            #{sortId},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="fhDate!=null">
                #{fhDate},
            </if>
            #{dwzl},
            <if test="fhr!=null">
                #{fhr},
            </if>
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <delete id="deleteCPSByQrId">
        DELETE FROM M_CPS
        WHERE QRCode_ID = #{0}
    </delete>

    <select id="getCP2ShowData" resultType="com.qdhualing.qrcodetracker.bean.BigCpOutGetDataResult">
         SELECT m.CP_Name , m.YLPC , m.SCPC , m.SC_Time as scDate , m.GG , s.SortName
        FROM M_CPS2 m LEFT JOIN Hl_Sort s on m.SortID = s.SortID
        WHERE m.QRCode_ID = #{0}
    </select>

    <delete id="deleteCPSByCps2QrId">
        DELETE FROM M_CPS
        WHERE CPS2_QRCode = #{0}
    </delete>

    <delete id="deleteCPS2ByQrId">
        DELETE FROM M_CPS2
        WHERE QRCode_ID = #{0}
    </delete>

    <insert id="insertCPOut" parameterType="com.qdhualing.qrcodetracker.bean.BigCpOutParam">
        insert into M_CPOut
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="cpName!=null">
                CP_Name,
            </if>
            SortID,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="fhDate!=null">
                FHDate,
            </if>
            DWZL,
            <if test="fhr!=null">
                FHR,
            </if>
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="remark!=null">
                remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="cpName!=null">
                #{cpName},
            </if>
            #{sortId},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="fhDate!=null">
                #{fhDate},
            </if>
            #{dwzl},
            <if test="fhr!=null">
                #{fhr},
            </if>
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <update id="updateCPIn2" parameterType="com.qdhualing.qrcodetracker.bean.BigCpBean">
        UPDATE M_CPIn2
        SET
        Now_Num = #{nowNum},
        IfFull = #{ifFull},
        SmlPk1	= #{smlPk1},
        SmlPk2	= #{smlPk2},
        SmlPk3	= #{smlPk3},
        SmlPk4		= #{smlPk4},
        SmlPk5		= #{smlPk5},
        SmlPk6	= #{smlPk6},
        SmlPk7	= #{smlPk7},
        SmlPk8		= #{smlPk8},
        SmlPk9		= #{smlPk9},
        SmlPk10		= #{smlPk10},
        SmlPk11		= #{smlPk11},
        SmlPk12		= #{smlPk12},
        SmlPk13		= #{smlPk13},
        SmlPk14		= #{smlPk14},
        SmlPk15		= #{smlPk15},
        SmlPk16		= #{smlPk16},
        SmlPk17		= #{smlPk17},
        SmlPk18		= #{smlPk18},
        SmlPk19		= #{smlPk19},
        SmlPk20		= #{smlPk20},
        SmlPk21		= #{smlPk21},
        SmlPk22		= #{smlPk22},
        SmlPk23	= #{smlPk23},
        SmlPk24	= #{smlPk24},
        SmlPk25		= #{smlPk25},
        SmlPk26		= #{smlPk26},
        SmlPk27		= #{smlPk27},
        SmlPk28		= #{smlPk28},
        SmlPk29		= #{smlPk29},
        SmlPk30		= #{smlPk30},
        SmlPk31	= #{smlPk31},
        SmlPk32		= #{smlPk32},
        SmlPk33		= #{smlPk33},
        SmlPk34		= #{smlPk34},
        SmlPk35		= #{smlPk35},
        SmlPk36		= #{smlPk36},
        SmlPk37		= #{smlPk37},
        SmlPk38	= #{smlPk38},
        SmlPk39	= #{smlPk39},
        SmlPk40		= #{smlPk40},
        SmlPk41		= #{smlPk41},
        SmlPk42		= #{smlPk42},
        SmlPk43	= #{smlPk43},
        SmlPk44		= #{smlPk44},
        SmlPk45		= #{smlPk45},
        SmlPk46	= #{smlPk46},
        SmlPk47		= #{smlPk47},
        SmlPk48		= #{smlPk48},
        SmlPk49		= #{smlPk49},
        SmlPk50		= #{smlPk50}
        WHERE QRCode_ID = #{qRCodeID}
    </update>

    <update id="updateCPS2" parameterType="com.qdhualing.qrcodetracker.bean.BigCpBean">
      UPDATE M_CPS2
      SET
        Now_Num = #{nowNum},
        IfFull = #{ifFull},
        SmlPk1	= #{smlPk1},
        SmlPk2	= #{smlPk2},
        SmlPk3	= #{smlPk3},
      SmlPk4		= #{smlPk4},
      SmlPk5		= #{smlPk5},
      SmlPk6	= #{smlPk6},
      SmlPk7	= #{smlPk7},
SmlPk8		= #{smlPk8},
SmlPk9		= #{smlPk9},
SmlPk10		= #{smlPk10},
SmlPk11		= #{smlPk11},
SmlPk12		= #{smlPk12},
SmlPk13		= #{smlPk13},
SmlPk14		= #{smlPk14},
SmlPk15		= #{smlPk15},
SmlPk16		= #{smlPk16},
SmlPk17		= #{smlPk17},
SmlPk18		= #{smlPk18},
SmlPk19		= #{smlPk19},
SmlPk20		= #{smlPk20},
SmlPk21		= #{smlPk21},
SmlPk22		= #{smlPk22},
SmlPk23	= #{smlPk23},
SmlPk24	= #{smlPk24},
SmlPk25		= #{smlPk25},
SmlPk26		= #{smlPk26},
SmlPk27		= #{smlPk27},
SmlPk28		= #{smlPk28},
SmlPk29		= #{smlPk29},
SmlPk30		= #{smlPk30},
SmlPk31	= #{smlPk31},
SmlPk32		= #{smlPk32},
SmlPk33		= #{smlPk33},
SmlPk34		= #{smlPk34},
SmlPk35		= #{smlPk35},
SmlPk36		= #{smlPk36},
SmlPk37		= #{smlPk37},
SmlPk38	= #{smlPk38},
SmlPk39	= #{smlPk39},
SmlPk40		= #{smlPk40},
SmlPk41		= #{smlPk41},
SmlPk42		= #{smlPk42},
SmlPk43	= #{smlPk43},
SmlPk44		= #{smlPk44},
SmlPk45		= #{smlPk45},
      SmlPk46	= #{smlPk46},
      SmlPk47		= #{smlPk47},
      SmlPk48		= #{smlPk48},
        SmlPk49		= #{smlPk49},
        SmlPk50		= #{smlPk50}
      WHERE QRCode_ID = #{qRCodeID}
    </update>

    <select id="getCPS2" resultType="com.qdhualing.qrcodetracker.bean.BigCpBean">
        SELECT *
        FROM M_CPS2
        WHERE QRCode_ID = #{0}
    </select>

    <insert id="insertCPIn" parameterType="com.qdhualing.qrcodetracker.bean.SmallCPINParam">
        insert into M_CPIn
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                CP_Name,
            </if>
            SortID,
            SHL,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            BZ,
            <if test="indh!=null">
                InDh,
            </if>
            <if test="cPS2QRCode!=null">
                CPS2_QRCode,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            #{sortID},
            #{shl},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            #{bz},
            <if test="indh!=null">
                #{indh},
            </if>
            <if test="cPS2QRCode!=null">
                #{cPS2QRCode},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
        </trim>
    </insert>


    <insert id="insertCPS" parameterType="com.qdhualing.qrcodetracker.bean.SmallCPINParam">
        insert into M_CPS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                CP_Name,
            </if>
            SortID,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="cPS2QRCode!=null">
                CPS2_QRCode,
            </if>
            <if test="gg!=null">
                GG,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            #{sortID},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="cPS2QRCode!=null">
                #{cPS2QRCode},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
        </trim>
    </insert>

    <select id="findCPS" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_CPS
        WHERE QRCode_ID = #{0}
    </select>
    <select id="getBigCpData" resultType="com.qdhualing.qrcodetracker.bean.BigCpBean">
        SELECT *
        FROM M_CPIn2
        WHERE IfFull=0
    </select>

    <insert id="insertCPS2" parameterType="com.qdhualing.qrcodetracker.bean.BigCPINParam">
        insert into M_CPS2
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                CP_Name,
            </if>
            SortID,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="jybz!=null">
                JYBZ,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="gg!=null">
                GG,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            #{sortID},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="jybz!=null">
                #{jybz},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="dw!=null">
                #{gg},
            </if>
        </trim>
    </insert>


    <select id="findCPS2" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_CPS2
        WHERE QRCode_ID = #{0}
    </select>

    <insert id="insertCPIn2" parameterType="com.qdhualing.qrcodetracker.bean.BigCPINParam">
        insert into M_CPIn2
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                CP_Name,
            </if>
            SortID,
            <if test="cpCode!=null">
                CP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="jybz!=null">
                JYBZ,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="indh!=null">
                InDh,
            </if>
            BZ,
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            #{sortID},
            <if test="cpCode!=null">
                #{cpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="jybz!=null">
                #{jybz},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="dw!=null">
                #{gg},
            </if>
            <if test="indh!=null">
                #{indh},
            </if>
            #{bz},
        </trim>
    </insert>

    <insert id="createBCP_CKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateBCPCKDParam">
        insert into Ckd_Bcp
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="lhDw!=null">
                LhDw,
            </if>
            <if test="jhDw!=null">
                JhDw,
            </if>
            <if test="lhRq!=null">
                LhRq,
            </if>
            <if test="fhr!=null">
                FhR,
            </if>
            <if test="bzID!=null">
                BzID,
            </if>
            <if test="bz!=null">
                Bz,
            </if>
            <if test="bzStatus!=null">
                BzStatus,
            </if>
            <if test="llfzrID!=null">
                LlfzrID,
            </if>
            <if test="lhFzr!=null">
                LhFzr,
            </if>
            <if test="llfzrStatus!=null">
                LlfzrStatus,
            </if>
            <if test="kgID!=null">
                KgID,
            </if>
            <if test="kg!=null">
                Kg,
            </if>
            <if test="kgStatus!=null">
                KgStatus,
            </if>
            <if test="fzrID!=null">
                FzrID,
            </if>
            <if test="fhFzr!=null">
                FhFzr,
            </if>
            <if test="fzrStatus!=null">
                FzrStatus,
            </if>
            <if test="remark!=null">
                Remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="lhDw!=null">
                #{lhDw},
            </if>
            <if test="jhDw!=null">
                #{jhDw},
            </if>
            <if test="lhRq!=null">
                #{lhRq},
            </if>
            <if test="fhr!=null">
                #{fhr},
            </if>
            <if test="bzID!=null">
                #{bzID},
            </if>
            <if test="bz!=null">
                #{bz},
            </if>
            <if test="bzStatus!=null">
                #{bzStatus},
            </if>
            <if test="llfzrID!=null">
                #{llfzrID},
            </if>
            <if test="lhFzr!=null">
                #{lhFzr},
            </if>
            <if test="llfzrStatus!=null">
                #{llfzrStatus},
            </if>
            <if test="kgID!=null">
                #{kgID},
            </if>
            <if test="kg!=null">
                #{kg},
            </if>
            <if test="kgStatus!=null">
                #{kgStatus},
            </if>
            <if test="fzrID!=null">
                #{fzrID},
            </if>
            <if test="fhFzr!=null">
                #{fhFzr},
            </if>
            <if test="fzrStatus!=null">
                #{fzrStatus},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <update id="updateBCPTempSByBCPTk" parameterType="com.qdhualing.qrcodetracker.bean.BCPTKParam">
        UPDATE M_BCPTempS
        SET
        SYZL = SYZL - #{tkzl},
        SHL = (SYZL - #{tkzl})/RKZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <update id="updateBCPSByTk" parameterType="com.qdhualing.qrcodetracker.bean.BCPTKParam">
        UPDATE M_BCPS
        SET
        SYZL = SYZL + #{tkzl},
        SHL = (SYZL + #{tkzl})/RKZL
        WHERE QRCode_ID = #{qrCodeId}
    </update>

    <insert id="insertBCPS" parameterType="com.qdhualing.qrcodetracker.bean.BCPTKParam">
        insert into M_BCPS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="sortID!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            SHL,
            <if test="scTime!=null">
                SC_Time,
            </if>
            RKZL,
            DWZL,
            SYZL,
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="tlzl1!=null">
                Tlzl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="tlzl2!=null">
                Tlzl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="tlzl3!=null">
                Tlzl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="tlzl4!=null">
                Tlzl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="tlzl5!=null">
                Tlzl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="tlzl6!=null">
                Tlzl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="tlzl7!=null">
                Tlzl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="tlzl8!=null">
                Tlzl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="tlzl9!=null">
                Tlzl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
            <if test="tlzl10!=null">
                Tlzl_10,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="dw!=null">
                DW,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="sortID!=null">
                #{sortID},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            #{shl},
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{rkzl},
            #{dwzl},
            #{tkzl},
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="tlzl1!=null">
                #{tlzl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="tlzl2!=null">
                #{tlzl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="tlzl3!=null">
                #{tlzl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="tlzl4!=null">
                #{tlzl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="tlzl5!=null">
                #{tlzl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="tlzl6!=null">
                #{tlzl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="tlzl7!=null">
                #{tlzl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="tlzl8!=null">
                #{tlzl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="tlzl9!=null">
                #{tlzl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
            <if test="tlzl10!=null">
                #{tlzl10},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
        </trim>
    </insert>

    <select id="getBCPSCount" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_BCPS
        WHERE QRCode_ID = #{0}
    </select>

    <insert id="insertBCPBk" parameterType="com.qdhualing.qrcodetracker.bean.BCPTKParam">
        insert into M_BCPBk
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="sortID!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            SHL,
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            PCZL,
            SYZL,
            TKZL,
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="backDh!=null">
                BackDh,
            </if>
            <if test="remark!=null">
                remark,
            </if>
            <if test="tkTime!=null">
                TK_Time,
            </if>
            <if test="thr!=null">
                Thr,
            </if>
            <if test="shrr!=null">
                Shr,
            </if>
            <if test="thDw!=null">
                ThDw,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="tlzl1!=null">
                Tlzl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="tlzl2!=null">
                Tlzl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="tlzl3!=null">
                Tlzl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="tlzl4!=null">
                Tlzl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="tlzl5!=null">
                Tlzl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="tlzl6!=null">
                Tlzl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="tlzl7!=null">
                Tlzl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="tlzl8!=null">
                Tlzl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="tlzl9!=null">
                Tlzl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
            <if test="tlzl10!=null">
                Tlzl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="sortID!=null">
                #{sortID},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            #{shl},
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            #{rkzl},
            #{syzl},
            #{tkzl},
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="backDh!=null">
                #{backDh},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
            <if test="tkTime!=null">
                #{tkTime},
            </if>
            <if test="thr!=null">
                #{thr},
            </if>
            <if test="shrr!=null">
                #{shrr},
            </if>
            <if test="thDw!=null">
                #{thDw},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="tlzl1!=null">
                #{tlzl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="tlzl2!=null">
                #{tlzl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="tlzl3!=null">
                #{tlzl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="tlzl4!=null">
                #{tlzl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="tlzl5!=null">
                #{tlzl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="tlzl6!=null">
                #{tlzl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="tlzl7!=null">
                #{tlzl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="tlzl8!=null">
                #{tlzl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="tlzl9!=null">
                #{tlzl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
            <if test="tlzl10!=null">
                #{tlzl10},
            </if>
        </trim>
    </insert>

    <select id="getTKDBCPBean" resultType="com.qdhualing.qrcodetracker.bean.TKDBCPBean">
        SELECT *
        FROM Tkd_Bcp
        WHERE BackDh = #{0}
    </select>

    <select id="getBCPTKShowData" resultType="com.qdhualing.qrcodetracker.bean.BCPTKShowDataResult">
        SELECT M_BCPTempS.ProductName , M_BCPTempS.DWZL ,M_BCPTempS.SYZL ,  M_BCPTempS.SHL , M_BCPTempS.YLPC , M_BCPTempS.SCPC , M_BCPTempS.SC_Time , M_BCPTempS.GG , M_BCPTempS.DW , Pdt_Sort2.Sort_Name
        FROM M_BCPTempS LEFT JOIN Pdt_Sort2 on M_BCPTempS.SortID = Pdt_Sort2.ID
        WHERE M_BCPTempS.QRCode_ID = #{0}
    </select>

    <insert id="createBCP_TKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateBCPTKDParam">
        insert into Tkd_Bcp
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="backDh!=null">
                BackDh,
            </if>
            <if test="thDw!=null">
                ThDw,
            </if>
            <if test="thRq!=null">
                ThRq,
            </if>
            <if test="thr!=null">
                ThR,
            </if>
            <if test="shrr!=null">
                Shr,
            </if>
            <if test="bzID!=null">
                BzID,
            </if>
            <if test="bz!=null">
                Bz,
            </if>
            <if test="bzStatus!=null">
                BzStatus,
            </if>
            <if test="tlfzrID!=null">
                TlfzrID,
            </if>
            <if test="thFzr!=null">
                ThFzr,
            </if>
            <if test="tlfzrStatus!=null">
                TlfzrStatus,
            </if>
            <if test="zjyID!=null">
                ZjyID,
            </if>
            <if test="zjy!=null">
                Zjy,
            </if>
            <if test="zjyStatus!=null">
                ZjyStatus,
            </if>
            <if test="zjldID!=null">
                ZjldID,
            </if>
            <if test="zjld!=null">
                Zjld,
            </if>
            <if test="zjldStatus!=null">
                ZjldStatus,
            </if>
            <if test="kgID!=null">
                KgID,
            </if>
            <if test="kg!=null">
                Kg,
            </if>
            <if test="kgStatus!=null">
                KgStatus,
            </if>
            <if test="slfzrID!=null">
                SlfzrID,
            </if>
            <if test="shFzr!=null">
                ShFzr,
            </if>
            <if test="slfzrStatus!=null">
                SlfzrStatus,
            </if>
            <if test="remark!=null">
                Remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="backDh!=null">
                #{backDh},
            </if>
            <if test="thDw!=null">
                #{thDw},
            </if>
            <if test="thRq!=null">
                #{thRq},
            </if>
            <if test="thr!=null">
                #{thr},
            </if>
            <if test="shrr!=null">
                #{shrr},
            </if>
            <if test="bzID!=null">
                #{bzID},
            </if>
            <if test="bz!=null">
                #{bz},
            </if>
            <if test="bzStatus!=null">
                #{bzStatus},
            </if>
            <if test="tlfzrID!=null">
                #{tlfzrID},
            </if>
            <if test="thFzr!=null">
                #{thFzr},
            </if>
            <if test="tlfzrStatus!=null">
                #{tlfzrStatus},
            </if>
            <if test="zjyID!=null">
                #{zjyID},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="zjyStatus!=null">
                #{zjyStatus},
            </if>
            <if test="zjldID!=null">
                #{zjldID},
            </if>
            <if test="zjld!=null">
                #{zjld},
            </if>
            <if test="zjldStatus!=null">
                #{zjldStatus},
            </if>
            <if test="kgID!=null">
                #{kgID},
            </if>
            <if test="kg!=null">
                #{kg},
            </if>
            <if test="kgStatus!=null">
                #{kgStatus},
            </if>
            <if test="slfzrID!=null">
                #{slfzrID},
            </if>
            <if test="shFzr!=null">
                #{shFzr},
            </if>
            <if test="slfzrStatus!=null">
                #{slfzrStatus},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <update id="updateBcpTempSByTl" parameterType="com.qdhualing.qrcodetracker.bean.BcpThrowParam">
        UPDATE M_BCPTempS
        SET
        SYZL = SYZL - #{tlzl},
        SHL = (SYZL - #{tlzl})/RKZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <delete id="deleteFromBcpTempS">
        DELETE FROM M_BCPTempS
        WHERE QRCode_ID = #{0}
    </delete>

    <update id="updateBcpTl" parameterType="com.qdhualing.qrcodetracker.bean.BcpThrowParam">
        UPDATE M_BCPTl
        SET
        SYZL = SYZL + #{tlzl},
        SHL = (SYZL + #{tlzl})/RKZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <insert id="insertBcpTl" parameterType="com.qdhualing.qrcodetracker.bean.BcpThrowParam">
        insert into M_BCPTl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrcodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="sortId!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            SHL,
            <if test="scTime!=null">
                SC_Time,
            </if>
            RKZL,
            DWZL,
            SYZL,
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="cjId!=null">
                CJ_ID,
            </if>
            <if test="gxId!=null">
                GX_ID,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="remark!=null">
                remark,
            </if>
            <if test="tlTime!=null">
                TL_Time,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="tlzl1!=null">
                Tlzl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="tlzl2!=null">
                Tlzl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="tlzl3!=null">
                Tlzl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="tlzl4!=null">
                Tlzl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="tlzl5!=null">
                Tlzl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="tlzl6!=null">
                Tlzl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="tlzl7!=null">
                Tlzl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="tlzl8!=null">
                Tlzl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="tlzl9!=null">
                Tlzl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
            <if test="tlzl10!=null">
                Tlzl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrcodeId!=null">
                #{qrcodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="sortId!=null">
                #{sortId},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            #{tlShl},
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{rkzl},
            #{dwzl},
            #{tlzl},
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="cjId!=null">
                #{cjId},
            </if>
            <if test="gxId!=null">
                #{gxId},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
            <if test="tlTime!=null">
                #{tlTime},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="tlzl1!=null">
                #{tlzl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="tlzl2!=null">
                #{tlzl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="tlzl3!=null">
                #{tlzl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="tlzl4!=null">
                #{tlzl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="tlzl5!=null">
                #{tlzl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="tlzl6!=null">
                #{tlzl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="tlzl7!=null">
                #{tlzl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="tlzl8!=null">
                #{tlzl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="tlzl9!=null">
                #{tlzl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
            <if test="tlzl10!=null">
                #{tlzl10},
            </if>
        </trim>
    </insert>

    <select id="getBcpTLDataCount" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_BCPTl
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getBCPTl" resultType="com.qdhualing.qrcodetracker.bean.BcpThrowShowDataResult">
        SELECT *
        FROM M_BCPTl
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getBcpTempS" resultType="com.qdhualing.qrcodetracker.bean.BCPTempSBean">
        SELECT *
        FROM M_BCPTempS
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getBcpTempSData" resultType="com.qdhualing.qrcodetracker.bean.BcpThrowShowDataResult">
        SELECT M_BCPTempS.ProductName, M_BCPTempS.SortID, M_BCPTempS.DWZL , M_BCPTempS.SYZL , M_BCPTempS.SHL , M_BCPTempS.YLPC , M_BCPTempS.SCPC , M_BCPTempS.SC_Time , M_BCPTempS.CheJian, M_BCPTempS.GX,
        M_BCPTempS.Yl_1,M_BCPTempS.Yl_2,M_BCPTempS.Yl_3,M_BCPTempS.Yl_4,M_BCPTempS.Yl_5,M_BCPTempS.Yl_6,M_BCPTempS.Yl_7,M_BCPTempS.Yl_8,M_BCPTempS.Yl_9,M_BCPTempS.Yl_10,
        M_BCPTempS.CZY, M_BCPIn.ZJY, M_BCPIn.ZJZT jyzt, M_BCPTempS.GG , M_BCPTempS.DW , Pdt_Sort2.Sort_Name
        FROM M_BCPTempS LEFT JOIN M_BCPIn on M_BCPTempS.QRCode_ID=M_BCPIn.QRCode_ID LEFT JOIN Pdt_Sort2 on M_BCPTempS.SortID = Pdt_Sort2.ID
        WHERE M_BCPTempS.QRCode_ID = #{0}
    </select>

    <update id="updateBCPTempS" parameterType="com.qdhualing.qrcodetracker.bean.BCPINParam">
        UPDATE M_BCPTempS
        SET
        SYZL = SYZL+#{rkzl},
        SHL = (SYZL+#{rkzl})/RKZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <insert id="insertBCPTempS" parameterType="com.qdhualing.qrcodetracker.bean.BCPINParam">
        insert into M_BCPTempS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="sortID!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            SHL,
            <if test="scTime!=null">
                SC_Time,
            </if>
            RKZL,
            DWZL,
            SYZL,
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="jybz!=null">
                JYBZ,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="tlzl1!=null">
                Tlzl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="tlzl2!=null">
                Tlzl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="tlzl3!=null">
                Tlzl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="tlzl4!=null">
                Tlzl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="tlzl5!=null">
                Tlzl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="tlzl6!=null">
                Tlzl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="tlzl7!=null">
                Tlzl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="tlzl8!=null">
                Tlzl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="tlzl9!=null">
                Tlzl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
            <if test="tlzl10!=null">
                Tlzl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="sortID!=null">
                #{sortID},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            #{shl},
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{rkzl},
            #{dwzl},
            #{syzl},
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="jybz!=null">
                #{jybz},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="tlzl1!=null">
                #{tlzl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="tlzl2!=null">
                #{tlzl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="tlzl3!=null">
                #{tlzl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="tlzl4!=null">
                #{tlzl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="tlzl5!=null">
                #{tlzl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="tlzl6!=null">
                #{tlzl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="tlzl7!=null">
                #{tlzl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="tlzl8!=null">
                #{tlzl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="tlzl9!=null">
                #{tlzl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
            <if test="tlzl10!=null">
                #{tlzl10},
            </if>
        </trim>
    </insert>

    <select id="findBCPTempS" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_BCPTempS
        WHERE QRCode_ID = #{0}
    </select>

    <update id="updateCPIn2ByParam" parameterType="com.qdhualing.qrcodetracker.bean.BigCPINParam">
        update M_CPIn2
        set
        CP_Name = #{productName},
        SortID = #{sortID},
        CP_Code = #{cpCode},
        YLPC = #{ylpc},
        SCPC = #{scpc},
        SC_Time = #{scTime},
        DWZL = #{dwzl},
        CZY = #{czy},
        ZJY = #{zjy},
        JYZT = #{jyzt},
        JYBZ = #{jybz},
        DW = #{dw},
        GG = #{gg},
        Indh = #{indh}
        where QRCode_ID=#{qrCodeId}
    </update>

    <update id="updateCPIn" parameterType="com.qdhualing.qrcodetracker.bean.SmallCPINParam">
        update M_CPIn
        set
        CP_Name=#{productName},
        SortID=#{sortID},
        SHL=#{shl},
        CP_Code=#{cpCode},
        YLPC=#{ylpc},
        SCPC=#{scpc},
        SC_Time=#{scTime},
        DWZL=#{dwzl},
        CZY=#{czy},
        ZJY=#{zjy},
        JYZT=#{jyzt},
        DW=#{dw},
        BZ=#{bz},
        InDh=#{indh},
        CPS2_QRCode=#{cPS2QRCode},
        GG=#{gg},
        Yl_1=#{yl1},
        Tlzl_1=#{tlzl1},
        Yl_2=#{yl2},
        Tlzl_2=#{tlzl2},
        Yl_3=#{yl3},
        Tlzl_3=#{tlzl3},
        Yl_4=#{yl4},
        Tlzl_4=#{tlzl4},
        Yl_5=#{yl5},
        Tlzl_5=#{tlzl5},
        Yl_6=#{yl6},
        Tlzl_6=#{tlzl6},
        Yl_7=#{yl7},
        Tlzl_7=#{tlzl7},
        Yl_8=#{yl8},
        Tlzl_8=#{tlzl8},
        Yl_9=#{yl9},
        Tlzl_9=#{tlzl9},
        Yl_10=#{yl10},
        Tlzl_10=#{tlzl10}
        where QRCode_ID=#{qrCodeId}
    </update>
    <update id="updateBcpIn" parameterType="com.qdhualing.qrcodetracker.bean.BCPINParam">
        update M_BCPIn
        set   ProductName=#{productName},
                SortID=#{sortID},
                BCP_Code= #{bcpCode},
                YLPC =#{ylpc},
                SCPC=#{scpc},
                GG= #{gg},
                SHL=#{shl},
                SC_Time=#{scTime},
                RKZL= #{rkzl},
                DWZL= #{dwzl},
                SYZL= #{syzl},
                KS_Time=#{ksTime},
                WC_Time=#{wcTime},
                GX=#{gx},
                CZY=#{czy},
                ZJY=#{zjy},
                JYZT=#{jyzt},
                JYBZ= #{jybz},
                BZ= #{bz},
                CheJian=#{cheJian},
                InDh=#{indh},
                DW=#{dw},
                Yl_1= #{yl1},
                Tlzl_1= #{tlzl1},
                Yl_2= #{yl2},
                Tlzl_2= #{tlzl2},
                Yl_3=#{yl3},
                Tlzl_3= #{tlzl3},
                Yl_4= #{yl4},
                Tlzl_4= #{tlzl4},
                Yl_5=#{yl5},
                Tlzl_5= #{tlzl5},
                Yl_6= #{yl6},
                Tlzl_6= #{tlzl6},
                Yl_7= #{yl7},
                Tlzl_7= #{tlzl7},
                Yl_8=#{yl8},
                Tlzl_8= #{tlzl8},
                Yl_9=#{yl9},
                Tlzl_9= #{tlzl9},
                Yl_10=#{yl10},
                Tlzl_10= #{tlzl10}
    where QRCode_ID=#{qrCodeId}
    </update>

    <update id="updateBcpRkdStatusByQRCodeID">
        UPDATE Rkd_Bcp SET BzStatus=0,FzrStatus=0,ZjyStatus=0,ZjldStatus=0
        WHERE InDh in (select m2.InDh from M_CPIn m1,M_CPIn2 m2 where m1.CPS2_QRCode=m2.QRCode_ID and m1.QRCode_ID=#{0})
    </update>

    <insert id="insertBCPIn" parameterType="com.qdhualing.qrcodetracker.bean.BCPINParam">
        insert into M_BCPIn
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="sortID!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="scpc!=null">
                SCPC,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            SHL,
            <if test="scTime!=null">
                SC_Time,
            </if>
            DWZL,
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="zjy!=null">
                ZJY,
            </if>
            <if test="jyzt!=null">
                JYZT,
            </if>
            <if test="jybz!=null">
                JYBZ,
            </if>
            <if test="bz!=null">
                BZ,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="indh!=null">
                InDh,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="sortID!=null">
                #{sortID},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="scpc!=null">
                #{scpc},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            #{shl},
            <if test="scTime!=null">
                #{scTime},
            </if>
            #{dwzl},
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="zjy!=null">
                #{zjy},
            </if>
            <if test="jyzt!=null">
                #{jyzt},
            </if>
            <if test="jybz!=null">
                #{jybz},
            </if>
            <if test="bz!=null">
                #{bz},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="indh!=null">
                #{indh},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
        </trim>
    </insert>

    <update id="updateWLTl" parameterType="com.qdhualing.qrcodetracker.bean.WLThrowParam">
        UPDATE M_WLTl
        SET
        SYZL = SYZL + #{tlzl},
        SHL = (SYZL + #{tlzl})/PCZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <select id="getWLTLDataCount" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_WLTl
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getWLTLDataByGxId" resultType="com.qdhualing.qrcodetracker.bean.TLYLBean">
        SELECT ID , QRCode_ID , ProductName, DW, SYZL, 0 as TLZL
        FROM M_WLTl
        WHERE GX_ID = #{0}
    </select>

    <select id="getBCPTLDataByGxId" resultType="com.qdhualing.qrcodetracker.bean.TLYLBean">
        SELECT ID , QRCode_ID , ProductName, DW, SYZL, 0 as TLZL
        FROM M_BCPTl
        WHERE GX_ID = #{0}
    </select>

    <insert id="createBCP_RKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateBCPRKDParam">
        insert into Rkd_Bcp
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="JhDw!=null">
                JhDw,
            </if>
            <if test="ShRq!=null">
                ShRq,
            </if>
            <if test="InDh!=null">
                InDh,
            </if>
            <if test="Jhr!=null">
                Jhr,
            </if>
            <if test="Shr!=null">
                Shr,
            </if>
            <if test="BzID!=null">
                BzID,
            </if>
            <if test="Bz!=null">
                Bz,
            </if>
            <if test="BzStatus!=null">
                BzStatus,
            </if>
            <if test="FzrID!=null">
                FzrID,
            </if>
            <if test="Fzr!=null">
                Fzr,
            </if>
            <if test="FzrStatus!=null">
                FzrStatus,
            </if>
            <if test="ZjyID!=null">
                ZjyID,
            </if>
            <if test="Zjy!=null">
                Zjy,
            </if>
            <if test="ZjyStatus!=null">
                ZjyStatus,
            </if>
            <if test="ZjldID!=null">
                ZjldID,
            </if>
            <if test="Zjld!=null">
                Zjld,
            </if>
            <if test="ZjldStatus!=null">
                ZjldStatus,
            </if>
            <if test="FlfzrID!=null">
                FlfzrID,
            </if>
            <if test="JhFzr!=null">
                JhFzr,
            </if>
            <if test="FlfzrStatus!=null">
                FlfzrStatus,
            </if>
            <if test="KgID!=null">
                KgID,
            </if>
            <if test="Kg!=null">
                Kg,
            </if>
            <if test="KgStatus!=null">
                KgStatus,
            </if>
            <if test="LlfzrID!=null">
                LlfzrID,
            </if>
            <if test="ShFzr!=null">
                ShFzr,
            </if>
            <if test="LlfzrStatus!=null">
                LlfzrStatus,
            </if>
            <if test="remark!=null">
                Remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="JhDw!=null">
                #{JhDw},
            </if>
            <if test="ShRq!=null">
                #{ShRq},
            </if>
            <if test="InDh!=null">
                #{InDh},
            </if>
            <if test="Jhr!=null">
                #{Jhr},
            </if>
            <if test="Shr!=null">
                #{Shr},
            </if>
            <if test="BzID!=null">
                #{BzID},
            </if>
            <if test="Bz!=null">
                #{Bz},
            </if>
            <if test="BzStatus!=null">
                #{BzStatus},
            </if>
            <if test="FzrID!=null">
                #{FzrID},
            </if>
            <if test="Fzr!=null">
                #{Fzr},
            </if>
            <if test="FzrStatus!=null">
                #{FzrStatus},
            </if>
            <if test="ZjyID!=null">
                #{ZjyID},
            </if>
            <if test="Zjy!=null">
                #{Zjy},
            </if>
            <if test="ZjyStatus!=null">
                #{ZjyStatus},
            </if>
            <if test="ZjldID!=null">
                #{ZjldID},
            </if>
            <if test="Zjld!=null">
                #{Zjld},
            </if>
            <if test="ZjldStatus!=null">
                #{ZjldStatus},
            </if>
            <if test="FlfzrID!=null">
                #{FlfzrID},
            </if>
            <if test="JhFzr!=null">
                #{JhFzr},
            </if>
            <if test="FlfzrStatus!=null">
                #{FlfzrStatus},
            </if>
            <if test="KgID!=null">
                #{KgID},
            </if>
            <if test="Kg!=null">
                #{Kg},
            </if>
            <if test="KgStatus!=null">
                #{KgStatus},
            </if>
            <if test="LlfzrID!=null">
                #{LlfzrID},
            </if>
            <if test="ShFzr!=null">
                #{ShFzr},
            </if>
            <if test="LlfzrStatus!=null">
                #{LlfzrStatus},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <select id="getGXData" resultType="com.qdhualing.qrcodetracker.bean.GXBean">
        SELECT *
        FROM Hl_GongXu
        WHERE id IN
        <foreach item="item" index="index" collection="array" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <select id="getCJData" resultType="com.qdhualing.qrcodetracker.bean.CJBean">
        SELECT *
        FROM Hl_CheJian
    </select>

    <update id="updateWLTempSByTl" parameterType="com.qdhualing.qrcodetracker.bean.WLThrowParam">
        UPDATE M_WLTempS
        SET
        SYZL = SYZL - #{tlzl},
        SHL = (SYZL - #{tlzl})/PCZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <update id="updateWLTlByBcpIn" parameterType="com.qdhualing.qrcodetracker.bean.WLThrowParam">
        UPDATE M_WLTl
        SET
        SYZL = SYZL - #{tlzl},
        SHL = (SYZL - #{tlzl})/PCZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <update id="updateBCPTlByBcpIn" parameterType="com.qdhualing.qrcodetracker.bean.BcpThrowParam">
        UPDATE M_BCPTl
        SET
        SYZL = SYZL - #{tlzl},
        SHL = (SYZL - #{tlzl})/RKZL
        WHERE QRCode_ID = #{qrcodeId};
    </update>

    <insert id="insertWLTl" parameterType="com.qdhualing.qrcodetracker.bean.WLThrowParam">
        insert into M_WLTl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrcodeId!=null">QRCode_ID,</if>
            <if test="productName!=null">ProductName,</if>
            PCZL,
            DWZL,
            SYZL,
            <if test="sortId!=null">SortID,</if>
            <if test="wlCode!=null">WL_Code,</if>
            <if test="ylpc!=null">YLPC,</if>
            <if test="gg!=null">GG,</if>
            <if test="dw!=null">DW,</if>
            <if test="cj!=null">TlCJ,</if>
            <if test="gx!=null">Tl_Gx,</if>
            <if test="cjId!=-1">CJ_ID,</if>
            <if test="gxId!=-1">GX_ID,</if>
            SHL,
            <if test="czy!=null">CZY,</if>
            <if test="tlTime!=null">Tl_TIME,</if>
            <if test="remark!=null">BZ,</if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrcodeId!=null">#{qrcodeId},</if>
            <if test="productName!=null">#{productName},</if>
            #{pczl},
            #{dwzl},
            #{tlzl},
            <if test="sortId!=null">#{sortId},</if>
            <if test="wlCode!=null">#{wlCode},</if>
            <if test="ylpc!=null">#{ylpc},</if>
            <if test="gg!=null">#{gg},</if>
            <if test="dw!=null">#{dw},</if>
            <if test="cj!=null">#{cj},</if>
            <if test="gx!=null">#{gx},</if>
            <if test="cjId!=null">#{cjId},</if>
            <if test="gxId!=null">#{gxId},</if>
            #{tlShl},
            <if test="czy!=null">#{czy},</if>
            <if test="tlTime!=null">#{tlTime},</if>
            <if test="remark!=null">#{remark},</if>
        </trim>
    </insert>

    <update id="updateWLTempSByTk" parameterType="com.qdhualing.qrcodetracker.bean.WLTKParam">
        UPDATE M_WLTempS
        SET
        SYZL = SYZL - #{tkzl},
        SHL = (SYZL - #{tkzl})/PCZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <delete id="deleteFromWLTempS">
        DELETE FROM M_WLTempS
        WHERE QRCode_ID = #{0}
    </delete>

    <delete id="deleteFromBCPS">
        DELETE FROM M_BCPS
        WHERE QRCode_ID = #{0}
    </delete>

    <delete id="deleteFromWLTl">
        DELETE FROM M_WLTl
        WHERE QRCode_ID = #{0}
    </delete>

    <delete id="deleteFromBCPTl">
        DELETE FROM M_BCPTl
        WHERE QRCode_ID = #{0}
    </delete>

    <update id="updateWLSByTk" parameterType="com.qdhualing.qrcodetracker.bean.WLTKParam">
        UPDATE M_WLS
        SET
        SYZL = SYZL + #{tkzl},
        SHL = (SYZL + #{tkzl})/PCZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <insert id="insertWLBk" parameterType="com.qdhualing.qrcodetracker.bean.WLTKParam">
        insert into M_WLBk
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">QRCode_ID,</if>
            <if test="productName!=null">ProductName,</if>
            DWZL,
            PCZL,
            SYZL,
            TKZL,
            <if test="sortId!=null">SortID,</if>
            <if test="wlCode!=null">WL_Code,</if>
            <if test="ylpc!=null">YLPC,</if>
            <if test="gg!=null">GG,</if>
            <if test="dw!=null">DW,</if>
            <if test="tkbm!=null">TKBM,</if>
            SHL,
            <if test="flr!=null">FLR,</if>
            <if test="llr!=null">LLR,</if>
            <if test="time!=null">TIME,</if>
            <if test="outDh!=null">OutDh,</if>
            <if test="czy!=null">CZY,</if>
            <if test="lLTime!=null">LL_Time,</if>
            <if test="chd!=null">CHD,</if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">#{qrCodeId},</if>
            <if test="productName!=null">#{productName},</if>
            #{dwzl},
            #{pczl},
            #{syzl},
            #{tkzl},
            <if test="sortId!=null">#{sortId},</if>
            <if test="wlCode!=null">#{wlCode},</if>
            <if test="ylpc!=null">#{ylpc},</if>
            <if test="gg!=null">#{gg},</if>
            <if test="dw!=null">#{dw},</if>
            <if test="tkbm!=null">#{tkbm},</if>
            #{tkShL},
            <if test="flr!=null">#{flr},</if>
            <if test="llr!=null">#{llr},</if>
            <if test="time!=null">#{time},</if>
            <if test="outDh!=null">#{outDh},</if>
            <if test="czy!=null">#{czy},</if>
            <if test="lLTime!=null">#{lLTime},</if>
            <if test="chd!=null">#{chd},</if>
        </trim>
    </insert>

    <select id="getWLTempS" resultType="com.qdhualing.qrcodetracker.bean.WLTempSBean">
        SELECT *
        FROM M_WLTempS
        WHERE QRCode_ID = #{0}
    </select>

    <select id="getWLTl" resultType="com.qdhualing.qrcodetracker.bean.WLThrowShowDataResult">
        SELECT *
        FROM M_WLTl
        WHERE QRCode_ID = #{0}
    </select>

    <select id="findWL_TKD" resultType="com.qdhualing.qrcodetracker.bean.TKDWLBean">
        SELECT *
        FROM Tkd_Wl
        WHERE BackDh = #{0}
    </select>

    <select id="getWLTempSData" resultType="com.qdhualing.qrcodetracker.bean.WLTKShowDataResult">
        SELECT M_WLTempS.ProductName ,M_WLTempS.PCZL,  M_WLTempS.DWZL , M_WLTempS.SYZL , M_WLTempS.SHL , M_WLTempS.CHD , M_WLTempS.GG , M_WLTempS.DW , Pdt_Sort2.Sort_Name
        FROM M_WLTempS LEFT JOIN Pdt_Sort2 on M_WLTempS.SortID = Pdt_Sort2.ID
        WHERE M_WLTempS.QRCode_ID = #{0}
    </select>


    <insert id="createWL_TKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateWLTKDParam">
        insert into Tkd_Wl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="backDh!=null">
                BackDh,
            </if>
            <if test="thDw!=null">
                ThDw,
            </if>
            <if test="thRq!=null">
                ThRq,
            </if>
            <if test="thr!=null">
                ThR,
            </if>
                BzID,
            <if test="bz!=null">
                Bz,
            </if>
            <if test="bzStatus!=null">
                BzStatus,
            </if>
            <if test="tlfzrID!=null">
                TlfzrID,
            </if>
            <if test="thFzr!=null">
                ThFzr,
            </if>
            <if test="tlfzrStatus!=null">
                TlfzrStatus,
            </if>
            <if test="kgID!=null">
                KgID,
            </if>
            <if test="kg!=null">
                Kg,
            </if>
            <if test="kgStatus!=null">
                KgStatus,
            </if>
            <if test="slfzrID!=null">
                SlfzrID,
            </if>
            <if test="shFzr!=null">
                ShFzr,
            </if>
            <if test="slfzrStatus!=null">
                SlfzrStatus,
            </if>
            <if test="remark!=null">
                Remark,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="backDh!=null">
                #{backDh},
            </if>
            <if test="thDw!=null">
                #{thDw},
            </if>
            <if test="thRq!=null">
                #{thRq},
            </if>
            <if test="thr!=null">
                #{thr},
            </if>
            <if test="bzID!=null">
                #{bzID},
            </if>
            <if test="bz!=null">
                #{bz},
            </if>
            <if test="bzStatus!=null">
                #{bzStatus},
            </if>
            <if test="tlfzrID!=null">
                #{tlfzrID},
            </if>
            <if test="thFzr!=null">
                #{thFzr},
            </if>
            <if test="tlfzrStatus!=null">
                #{tlfzrStatus},
            </if>
            <if test="kgID!=null">
                #{kgID},
            </if>
            <if test="kg!=null">
                #{kg},
            </if>
            <if test="kgStatus!=null">
                #{kgStatus},
            </if>
            <if test="slfzrID!=null">
                #{slfzrID},
            </if>
            <if test="shFzr!=null">
                #{shFzr},
            </if>
            <if test="slfzrStatus!=null">
                #{slfzrStatus},
            </if>
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <update id="updateWLTempS" parameterType="com.qdhualing.qrcodetracker.bean.WLOutParam">
        UPDATE M_WLTempS
        SET
        LL_Time = #{time},
        SYZL = SYZL + #{ckzl},
        SHL = (SYZL+#{ckzl})/PCZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <select id="findWLTempS" resultType="java.lang.Integer">
        SELECT COUNT(0)
        FROM M_WLTempS
        WHERE QRCode_ID = #{0}
    </select>

    <insert id="insertWLTempS" parameterType="com.qdhualing.qrcodetracker.bean.WLOutParam">
        insert into M_WLTempS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">QRCode_ID,</if>
            <if test="productName!=null">ProductName,</if>
            PCZL,
            DWZL,
            SYZL,
            <if test="sortId!=null">SortID,</if>
            <if test="wlCode!=null">WL_Code,</if>
            <if test="ylpc!=null">YLPC,</if>
            <if test="gg!=null">GG,</if>
            SHL,
            <if test="llr!=null">CZY,</if>
            <if test="chd!=null">CHD,</if>
            <if test="time!=null">LL_Time,</if>
            <if test="dw!=null">DW</if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">#{qrCodeId},</if>
            <if test="productName!=null">#{productName},</if>
            #{pczl},
            #{dwzl},
            #{ckzl},
            <if test="sortId!=null">#{sortId},</if>
            <if test="wlCode!=null">#{wlCode},</if>
            <if test="ylpc!=null">#{ylpc},</if>
            <if test="gg!=null">#{gg},</if>
            #{ckShL},
            <if test="llr!=null">#{llr},</if>
            <if test="chd!=null">#{chd},</if>
            <if test="time!=null">#{time},</if>
            <if test="dw!=null">#{dw}</if>
        </trim>
    </insert>

    <select id="getUserGroupData" resultType="com.qdhualing.qrcodetracker.bean.UserGroupBean">
        SELECT *
        FROM Hl_UserGroup
    </select>

    <update id="outUpdateWLS" parameterType="com.qdhualing.qrcodetracker.bean.WLOutParam">
        UPDATE M_WLS
        SET
        SYZL = SYZL-#{ckzl},
        SHL = (SYZL-#{ckzl})/PCZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <delete id="deleteFromWLS">
        DELETE FROM M_WLS
        WHERE QRCode_ID = #{0}
    </delete>

    <update id="outUpdateBCPS" parameterType="com.qdhualing.qrcodetracker.bean.BcpOutParam">
        UPDATE M_BCPS
        SET
        SYZL = SYZL-#{ckzl},
        SHL = (SYZL-#{ckzl})/RKZL
        WHERE QRCode_ID = #{qrCodeId};
    </update>

    <insert id="insertWLOUT" parameterType="com.qdhualing.qrcodetracker.bean.WLOutParam">
        insert into M_WLOUT
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="dwzl!=null">
                DWZL,
            </if>
            <if test="pczl!=null">
                PCZL,
            </if>
            <if test="syzl!=null">
                SYZL,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="bz!=null">
                Bz,
            </if>
            <if test="sortId!=null">
                SortID,
            </if>
            <if test="wlCode!=null">
                WL_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="ckShL!=null">
                SHL,
            </if>
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="flr!=null">
                FLR,
            </if>
            <if test="llr!=null">
                LLR,
            </if>
            <if test="time!=null">
                TIME,
            </if>
            <if test="llbm!=null">
                LLBM,
            </if>
            <if test="ckzl!=null">
                CKZL,
            </if>
            <if test="chd!=null">
                CHD
            </if>
            <if test="czy!=null">
                CZY
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="dwzl!=null">
                #{dwzl},
            </if>
            <if test="pczl!=null">
                #{pczl},
            </if>
            <if test="syzl!=null">
                #{syzl},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="bz!=null">
                #{bz},
            </if>
            <if test="sortId!=null">
                #{sortId},
            </if>
            <if test="wlCode!=null">
                #{wlCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            <if test="ckShL!=null">
                #{ckShL},
            </if>
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="flr!=null">
                #{flr},
            </if>
            <if test="llr!=null">
                #{llr},
            </if>
            <if test="time!=null">
                #{time},
            </if>
            <if test="llbm!=null">
                #{llbm},
            </if>
            <if test="ckzl!=null">
                #{ckzl},
            </if>
            <if test="chd!=null">
                #{chd},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
        </trim>
    </insert>

    <insert id="insertBcpOUT" parameterType="com.qdhualing.qrcodetracker.bean.BcpOutParam">
        insert into M_BCPOUT
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                QRCode_ID,
            </if>
            <if test="productName!=null">
                ProductName,
            </if>
            <if test="dwzl!=null">
                DWZL,
            </if>
            <if test="rkzl!=null">
                RKZL,
            </if>
            <if test="syzl!=null">
                SYZL,
            </if>
            <if test="ckzl!=null">
                CKZL,
            </if>
            <if test="dw!=null">
                DW,
            </if>
            <if test="sortId!=null">
                SortID,
            </if>
            <if test="bcpCode!=null">
                BCP_Code,
            </if>
            <if test="ylpc!=null">
                YLPC,
            </if>
            <if test="gg!=null">
                GG,
            </if>
            <if test="ckShL!=null">
                SHL,
            </if>
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="flr!=null">
                FLR,
            </if>
            <if test="llr!=null">
                LLR,
            </if>
            <if test="time!=null">
                TIME,
            </if>
            <if test="llbm!=null">
                LLBM,
            </if>
            <if test="scTime!=null">
                SC_Time,
            </if>
            <if test="ksTime!=null">
                KS_Time,
            </if>
            <if test="wcTime!=null">
                WC_Time,
            </if>
            <if test="gx!=null">
                GX,
            </if>
            <if test="czy!=null">
                CZY,
            </if>
            <if test="cheJian!=null">
                CheJian,
            </if>
            <if test="yl1!=null">
                Yl_1,
            </if>
            <if test="tlzl1!=null">
                Tlzl_1,
            </if>
            <if test="yl2!=null">
                Yl_2,
            </if>
            <if test="tlzl2!=null">
                Tlzl_2,
            </if>
            <if test="yl3!=null">
                Yl_3,
            </if>
            <if test="tlzl3!=null">
                Tlzl_3,
            </if>
            <if test="yl4!=null">
                Yl_4,
            </if>
            <if test="tlzl4!=null">
                Tlzl_4,
            </if>
            <if test="yl5!=null">
                Yl_5,
            </if>
            <if test="tlzl5!=null">
                Tlzl_5,
            </if>
            <if test="yl6!=null">
                Yl_6,
            </if>
            <if test="tlzl6!=null">
                Tlzl_6,
            </if>
            <if test="yl7!=null">
                Yl_7,
            </if>
            <if test="tlzl7!=null">
                Tlzl_7,
            </if>
            <if test="yl8!=null">
                Yl_8,
            </if>
            <if test="tlzl8!=null">
                Tlzl_8,
            </if>
            <if test="yl9!=null">
                Yl_9,
            </if>
            <if test="tlzl9!=null">
                Tlzl_9,
            </if>
            <if test="yl10!=null">
                Yl_10,
            </if>
            <if test="tlzl10!=null">
                Tlzl_10,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qrCodeId!=null">
                #{qrCodeId},
            </if>
            <if test="productName!=null">
                #{productName},
            </if>
            <if test="dwzl!=null">
                #{dwzl},
            </if>
            <if test="rkzl!=null">
                #{rkzl},
            </if>
            <if test="syzl!=null">
                #{syzl},
            </if>
            <if test="ckzl!=null">
                #{ckzl},
            </if>
            <if test="dw!=null">
                #{dw},
            </if>
            <if test="sortId!=null">
                #{sortId},
            </if>
            <if test="bcpCode!=null">
                #{bcpCode},
            </if>
            <if test="ylpc!=null">
                #{ylpc},
            </if>
            <if test="gg!=null">
                #{gg},
            </if>
            <if test="ckShL!=null">
                #{ckShL},
            </if>
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="flr!=null">
                #{flr},
            </if>
            <if test="llr!=null">
                #{llr},
            </if>
            <if test="time!=null">
                #{time},
            </if>
            <if test="llbm!=null">
                #{llbm},
            </if>
            <if test="scTime!=null">
                #{scTime},
            </if>
            <if test="ksTime!=null">
                #{ksTime},
            </if>
            <if test="wcTime!=null">
                #{wcTime},
            </if>
            <if test="gx!=null">
                #{gx},
            </if>
            <if test="czy!=null">
                #{czy},
            </if>
            <if test="cheJian!=null">
                #{cheJian},
            </if>
            <if test="yl1!=null">
                #{yl1},
            </if>
            <if test="tlzl1!=null">
                #{tlzl1},
            </if>
            <if test="yl2!=null">
                #{yl2},
            </if>
            <if test="tlzl2!=null">
                #{tlzl2},
            </if>
            <if test="yl3!=null">
                #{yl3},
            </if>
            <if test="tlzl3!=null">
                #{tlzl3},
            </if>
            <if test="yl4!=null">
                #{yl4},
            </if>
            <if test="tlzl4!=null">
                #{tlzl4},
            </if>
            <if test="yl5!=null">
                #{yl5},
            </if>
            <if test="tlzl5!=null">
                #{tlzl5},
            </if>
            <if test="yl6!=null">
                #{yl6},
            </if>
            <if test="tlzl6!=null">
                #{tlzl6},
            </if>
            <if test="yl7!=null">
                #{yl7},
            </if>
            <if test="tlzl7!=null">
                #{tlzl7},
            </if>
            <if test="yl8!=null">
                #{yl8},
            </if>
            <if test="tlzl8!=null">
                #{tlzl8},
            </if>
            <if test="yl9!=null">
                #{yl9},
            </if>
            <if test="tlzl9!=null">
                #{tlzl9},
            </if>
            <if test="yl10!=null">
                #{yl10},
            </if>
            <if test="tlzl10!=null">
                #{tlzl10},
            </if>
        </trim>
    </insert>

    <select id="findBcpS" resultType="com.qdhualing.qrcodetracker.bean.BcpSBean">
        SELECT *
        FROM M_BcpS
        where QRCode_ID = #{0}
    </select>

    <select id="findWLS" resultType="com.qdhualing.qrcodetracker.bean.WLSBean">
        SELECT *
        FROM M_WLS
        where QRCode_ID = #{0}
    </select>

    <select id="findWL_CKD" resultType="com.qdhualing.qrcodetracker.bean.CKDWLBean">
        SELECT *
        FROM Ckd_Wl
        where OutDh = #{0}
    </select>

    <update id="updateWLS" parameterType="com.qdhualing.qrcodetracker.bean.WLINParam">

        UPDATE M_WLS
        SET YLPC = #{yLPC},
             PCZL = PCZL+#{pCZL},
            LL_Time = #{lLTime},
            SHL = SHL+#{shl}
        WHERE QRCode_ID = #{qRCodeID};

    </update>

    <insert id="insertWLS" parameterType="com.qdhualing.qrcodetracker.bean.WLINParam">
        insert into M_WLS
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qRCodeID!=null">QRCode_ID,</if>
            <if test="productName!=null">ProductName,</if>
            <if test="dWZL!=null">DWZL,</if>
            <if test="pCZL!=null">PCZL,</if>
            <if test="sYZL!=null">SYZL,</if>
            <if test="dW!=null">DW,</if>
            <if test="lb!=null">SortID,</if>
            <if test="wLCode!=null">WL_Code,</if>
            <if test="yLPC!=null">YLPC,</if>
            <if test="gG!=null">GG,</if>
            <if test="cHD!=null">CHD,</if>
            SHL,
            <if test="cZY!=null">CZY,</if>
            <if test="lLTime!=null">LL_Time</if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qRCodeID!=null">#{qRCodeID},</if>
            <if test="productName!=null">#{productName},</if>
            <if test="dWZL!=null">#{dWZL},</if>
            <if test="pCZL!=null">#{pCZL},</if>
            <if test="sYZL!=null">#{sYZL},</if>
            <if test="dW!=null">#{dW},</if>
            <if test="lb!=null">#{lb},</if>
            <if test="wLCode!=null">#{wLCode},</if>
            <if test="yLPC!=null">#{yLPC},</if>
            <if test="gG!=null">#{gG},</if>
            <if test="cHD!=null">#{cHD},</if>
            #{shl},
            <if test="cZY!=null">#{cZY},</if>
            <if test="lLTime!=null">#{lLTime}</if>
        </trim>
    </insert>

    <select id="queryWLS" resultType="java.lang.Integer">
		SELECT count(0)
		FROM M_WLS
		where QRCode_ID = #{0}
	</select>

    <select id="getWLSData" resultType="com.qdhualing.qrcodetracker.bean.WLOutShowDataResult">
        SELECT M_WLS.ProductName, M_WLS.PCZL , M_WLS.DWZL, M_WLS.SYZL, M_WLS.SHL, M_WLS.CHD, M_WLS.GG, M_WLS.DW, Hl_Sort.SortName
        FROM M_WLS left JOIN Hl_Sort on M_WLS.SortID = Hl_Sort.SortID
        where M_WLS.QRCode_ID = #{qrcodeId}
	</select>

    <select id="getBCPSData" resultType="com.qdhualing.qrcodetracker.bean.BCPOutShowDataResult">
        SELECT M_BCPS.ProductName, M_BCPS.RKZL , M_BCPS.DWZL, M_BCPS.SYZL, M_BCPS.SHL, M_BCPS.GG, M_BCPS.DW, Hl_Sort.SortName
        FROM M_BCPS left JOIN Hl_Sort on M_BCPS.SortID = Hl_Sort.SortID
        where M_BCPS.QRCode_ID = #{qrcodeId}
	</select>

    <insert id="createWLWT_CKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateWLCKDParam">
        insert into Ckd_WlWt
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="lhDw!=null">
                ShDw,
            </if>
            <if test="lhRq!=null">
                ShRq,
            </if>
            <if test="fhR!=null">
                Fhr,
            </if>
            <if test="lhR!=null">
                Shr,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="lhDw!=null">
                #{lhDw},
            </if>
            <if test="lhRq!=null">
                #{lhRq},
            </if>
            <if test="fhR!=null">
                #{fhR},
            </if>
            <if test="lhR!=null">
                #{lhR},
            </if>
        </trim>
    </insert>

    <insert id="createWL_CKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateWLCKDParam">
        insert into Ckd_Wl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                OutDh,
            </if>
            <if test="lhDw!=null">
                LhDw,
            </if>
            <if test="lhRq!=null">
                LhRq,
            </if>
            <if test="fhR!=null">
                FhR,
            </if>
            <if test="lhR!=null">
                LhR,
            </if>
                KgID,
            <if test="kg!=null">
                Kg,
            </if>
                KgStatus,
                FlfzrID,
            <if test="fhFzr!=null">
                FhFzr,
            </if>
                FlfzrStatus,
                BzID,
            <if test="bz!=null">
                Bz,
            </if>
                BzStatus,
                LlfzrID,
            <if test="lhFzr!=null">
                LhFzr,
            </if>
                LlfzrStatus,
            <if test="remark!=null">
                Remark
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="outDh!=null">
                #{outDh},
            </if>
            <if test="lhDw!=null">
                #{lhDw},
            </if>
            <if test="lhRq!=null">
                #{lhRq},
            </if>
            <if test="fhR!=null">
                #{fhR},
            </if>
            <if test="lhR!=null">
                #{lhR},
            </if>
                #{kgID},
            <if test="kg!=null">
                #{kg},
            </if>
                #{kgStatus},
                #{flfzrID},
            <if test="fhFzr!=null">
                #{fhFzr},
            </if>
                #{flfzrStatus},
                #{bzID},
            <if test="bz!=null">
                #{bz},
            </if>
                #{bzStatus},
                #{llfzrID},
            <if test="lhFzr!=null">
                #{lhFzr},
            </if>
                #{llfzrStatus},
            <if test="remark!=null">
                #{remark},
            </if>
        </trim>
    </insert>

    <select id="getParentHlSort" resultType="com.qdhualing.qrcodetracker.bean.HlSortBean">
		SELECT *
		FROM Hl_Sort WHERE 1=1
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@WL">
            AND ParentID=0 AND SortCode in(1,4,5)
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BCP">
            AND ParentID=0 AND SortCode in(2)
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@SMALL_CP||qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BIG_CP">
            AND ParentID=0 AND SortCode in(3)
        </if>
        ORDER BY SortOrder
	</select>

    <select id="getChildHlSort" resultType="com.qdhualing.qrcodetracker.bean.HlSortBean">
		SELECT *
		FROM Hl_Sort WHERE 1=1
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@WL||qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BCP">
            AND ParentID=#{parentID}
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@SMALL_CP">
            AND ParentID=#{parentID} AND SortCode in(501)
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BIG_CP">
            AND ParentID=#{parentID} AND SortCode in(502)
        </if>
        ORDER BY SortOrder
	</select>

    <select id="getHlProduct" resultType="com.qdhualing.qrcodetracker.bean.HlProductBean">
        SELECT *
		FROM Hl_Product WHERE SortID=#{0}
    </select>

    <select id="getPdtSort" resultType="com.qdhualing.qrcodetracker.bean.PdtSortBean">
		SELECT *
		FROM Pdt_Sort2
	</select>

    <select id="getMaterialInData" resultType="com.qdhualing.qrcodetracker.bean.DataResult">
		SELECT
		mwlin.*,mwls.YuJing,mwls.Company
		FROM M_WLIn as mwlin left join M_WLS as mwls
		on mwlin.QRCode_ID=mwls.QRCode_ID
		where mwlin.QRCode_ID=#{qrcodeId}
	</select>

    <insert id="createWLWT_RKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateWLRKDParam">
        insert into Rkd_WlWt
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="FhDw!=null">
                FhDw,
            </if>
            <if test="ShRq!=null">
                ShRq,
            </if>
            <if test="InDh!=null">
                InDh,
            </if>
            <if test="Shr!=null">
                Shr
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="FhDw!=null">
                #{FhDw},
            </if>
            <if test="ShRq!=null">
                #{ShRq},
            </if>
            <if test="InDh!=null">
                #{InDh},
            </if>
            <if test="Shr!=null">
                #{Shr}
            </if>
        </trim>
    </insert>

    <insert id="createWL_RKD" parameterType="com.qdhualing.qrcodetracker.bean.CreateWLRKDParam">
        insert into Rkd_Wl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="InDh!=null">
                InDh,
            </if>
            <if test="FhDw!=null">
                JhDw,
            </if>
            <if test="ShRq!=null">
                ShRq,
            </if>
            <if test="Shr!=null">
                Shr,
            </if>
            <if test="ZjyID!=null">
                ZjyID,
            </if>
            <if test="Zjy!=null">
                Zjy,
            </if>
            <if test="ZjyStatus!=null">
                ZjyStatus,
            </if>
            <if test="ZjldID!=null">
                ZjldID,
            </if>
            <if test="Zjld!=null">
                Zjld,
            </if>
            <if test="ZjldStatus!=null">
                ZjldStatus,
            </if>
            <if test="FzrID!=null">
                FzrID,
            </if>
            <if test="ShFzr!=null">
                ShFzr,
            </if>
            <if test="FzrStatus!=null">
                FzrStatus,
            </if>
            <if test="Remark!=null">
                Remark
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="InDh!=null">
                #{InDh},
            </if>
            <if test="FhDw!=null">
                #{FhDw},
            </if>
            <if test="ShRq!=null">
                #{ShRq},
            </if>
            <if test="Shr!=null">
                #{Shr},
            </if>
            <if test="ZjyID!=null">
                #{ZjyID},
            </if>
            <if test="Zjy!=null">
                #{Zjy},
            </if>
            <if test="ZjyStatus!=null">
                #{ZjyStatus},
            </if>
            <if test="ZjldID!=null">
                #{ZjldID},
            </if>
            <if test="Zjld!=null">
                #{Zjld},
            </if>
            <if test="ZjldStatus!=null">
                #{ZjldStatus},
            </if>
            <if test="FzrID!=null">
                #{FzrID},
            </if>
            <if test="ShFzr!=null">
                #{ShFzr},
            </if>
            <if test="FzrStatus!=null">
                #{FzrStatus},
            </if>
            <if test="Remark!=null">
                #{Remark}
            </if>
        </trim>
    </insert>

    <update id="updateWLIN_M" parameterType="com.qdhualing.qrcodetracker.bean.WLINParam">
        update M_WLIn
        set
            ProductName = #{productName},
            SYZL = #{sYZL},
            DWZL = #{dWZL},
            PCZL = #{pCZL},
            Unit = #{dW},
            Bz = #{bz},
            SortID = #{lb},
            remark = #{remark},
            WL_Code = #{wLCode},
            YLPC = #{yLPC},
            GG = #{gG},
            CHD = #{cHD},
            SHL = #{shl},
            InDh = #{inDh},
            CZY = #{cZY},
            LL_Time = #{lLTime}
        where QRCode_ID=#{qRCodeID}
    </update>

    <insert id="createWLIN_M" parameterType="com.qdhualing.qrcodetracker.bean.WLINParam">
        insert into M_WLIn
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qRCodeID!=null">QRCode_ID,</if>
            <if test="productName!=null">ProductName,</if>
            <if test="dWZL!=null">DWZL,</if>
            <if test="pCZL!=null">PCZL,</if>
            <if test="dW!=null">Unit,</if>
            <if test="bz!=null">Bz,</if>
            <if test="lb!=null">SortID,</if>
            <if test="remark!=null">remark,</if>
            <if test="wLCode!=null">WL_Code,</if>
            <if test="yLPC!=null">YLPC,</if>
            <if test="gG!=null">GG,</if>
            <if test="cHD!=null">CHD,</if>
            SHL,
            <if test="inDh!=null">InDh,</if>
            <if test="cZY!=null">CZY,</if>
            <if test="lLTime!=null">LL_Time</if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="qRCodeID!=null">#{qRCodeID},</if>
            <if test="productName!=null">#{productName},</if>
            <if test="dWZL!=null">#{dWZL},</if>
            <if test="pCZL!=null">#{pCZL},</if>
            <if test="dW!=null">#{dW},</if>
            <if test="bz!=null">#{bz},</if>
            <if test="lb!=null">#{lb},</if>
            <if test="remark!=null">#{remark},</if>
            <if test="wLCode!=null">#{wLCode},</if>
            <if test="yLPC!=null">#{yLPC},</if>
            <if test="gG!=null">#{gG},</if>
            <if test="cHD!=null">#{cHD},</if>
            #{shl},
            <if test="inDh!=null">#{inDh},</if>
            <if test="cZY!=null">#{cZY},</if>
            <if test="lLTime!=null">#{lLTime}</if>
        </trim>
    </insert>

    <select id="getCreateRKDParamByInDh" resultType="com.qdhualing.qrcodetracker.bean.CreateWLRKDParam">
		select * from
		Rkd_Wl where InDh=#{inDh}
	</select>

    <select id="getWLINParamListByInDh" resultType="com.qdhualing.qrcodetracker.bean.WLINParam">
		select *,SortID AS lb,Unit AS dW from
		M_WLIn where InDh=#{inDh}
	</select>

    <select id="getWLSParamByQRCode" resultType="com.qdhualing.qrcodetracker.bean.WLINParam">
		select * from M_WLS
		where QRCode_ID=#{qRCodeID}
	</select>

    <update id="updataWLINParamByQRCode">
		update M_WLS set PCZL=#{0}
		where QRCode_ID=#{1}
	</update>

    <select id="getXZQXData" resultType="com.qdhualing.qrcodetracker.bean.Module2Bean">
        SELECT ID,M_name name FROM M_Module2
    </select>

    <select id="getXZQXDataByShenFen" parameterType="com.qdhualing.qrcodetracker.bean.PersonParam" resultType="com.qdhualing.qrcodetracker.bean.Module2Bean">
        SELECT ID,M_name name FROM M_Module2 WHERE 1=1
        <if test="shenFen=='zjy'||shenFen=='zjld'">
            AND M_name='质检'
        </if>
        <if test="shenFen=='bz'||shenFen=='kg'||shenFen=='fzr'">
            AND M_name='审核'
        </if>
        <if test="shenFen=='ptyg'">
            AND M_name!='质检' AND M_name!='审核'
        </if>
    </select>

    <insert id="registerUser" parameterType="com.qdhualing.qrcodetracker.bean.PersonParam">
        INSERT INTO Hl_User
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="groupID!=0">
                GroupID,
            </if>
            <if test="loginName!=null">
                LoginName,
            </if>
            <if test="password!=null">
                Password,
            </if>
            <if test="userStatus!=null">
                UserStatus,
            </if>
            <if test="regTime!=null">
                RegTime,
            </if>
            <if test="trueName!=null">
                TrueName,
            </if>
            <if test="checkQXGroup!=null">
                CheckQXGroup,
            </if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="groupID!=0">
                #{groupID},
            </if>
            <if test="loginName!=null">
                #{loginName},
            </if>
            <if test="password!=null">
                #{password},
            </if>
            <if test="userStatus!=null">
                #{userStatus},
            </if>
            <if test="regTime!=null">
                #{regTime},
            </if>
            <if test="trueName!=null">
                #{trueName},
            </if>
            <if test="checkQXGroup!=null">
                #{checkQXGroup},
            </if>
        </trim>
    </insert>

    <update id="updateUserData" parameterType="com.qdhualing.qrcodetracker.bean.PersonResult">
        UPDATE Hl_User SET GroupID=#{groupID},LoginName=#{loginName},
        <if test="password!=null">
            Password=#{password},
        </if>
        TrueName=#{trueName},
        CheckQXGroup=#{checkQXGroup}
        WHERE UserID=#{userId}
    </update>

    <select id="checkLoginName" resultType="java.lang.Integer" parameterType="com.qdhualing.qrcodetracker.bean.PersonBean">
        SELECT count(*) FROM Hl_User WHERE LoginName=#{loginName}
        <if test="userId!=0">
            AND UserID!=#{userId}
        </if>
    </select>

    <delete id="deleteUser">
        DELETE FROM Hl_User WHERE UserID=#{0}
    </delete>

    <select id="checkExistByQrCodeId" resultType="java.lang.Integer">
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@WL">
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@MATERIAL_IN">
                SELECT count(*) FROM M_WLIn WHERE QRCode_ID=#{qrCodeId} AND InDh IS NOT NULL
            </if>
            <!--
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@MATERIAL_OUT">
                SELECT count(*) FROM M_WLOUT WHERE QRCode_ID=#{qrCodeId}
            </if>
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@MATERIAL_RETURN">
                SELECT count(*) FROM M_WLBK WHERE QRCode_ID=#{qrCodeId}
            </if>
            -->
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BCP">
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@HALF_PRODUCT_IN">
                SELECT count(*) FROM M_BCPIn WHERE QRCode_ID=#{qrCodeId} AND InDh IS NOT NULL
            </if>
            <!--
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@HALF_PRODUCT_RETURN">
                SELECT count(*) FROM M_BCPBk WHERE QRCode_ID=#{qrCodeId}
            </if>
            -->
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@BIG_CP">
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@PRODUCT_IN">
                SELECT count(*) FROM M_CPIn2 WHERE QRCode_ID=#{qrCodeId} AND InDh IS NOT NULL
            </if>
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@PRODUCT_OUT">
                SELECT count(*) FROM M_CPOut WHERE QRCode_ID=#{qrCodeId}
            </if>
        </if>
        <if test="qrCodeId.substring(8,9)==@com.qdhualing.qrcodetracker.bean.TrackType@SMALL_CP">
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@PRODUCT_IN">
                SELECT count(*) FROM M_CPIn WHERE QRCode_ID=#{qrCodeId} AND InDh IS NOT NULL
            </if>
            <if test="currentFunctionType==@com.qdhualing.qrcodetracker.model.FunctionType@PRODUCT_OUT">
                SELECT count(*) FROM M_CPOut WHERE QRCode_ID=#{qrCodeId}
            </if>
        </if>
    </select>
</mapper>